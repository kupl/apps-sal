["t=int(input())\nfor i in range(t):\n n,m=list(map(int,input().split()))\n l=[0]+list(map(int,input().split()))\n s=0\n c=1\n m1=[]\n for i in range(n):\n  d,f,b=list(map(int,input().split()))\n  if(l[d]>0):\n   m1.append(d)\n   s+=f\n   l[d]-=1\n  else:\n   m1.append(0)\n   s+=b\n for i in range(n):\n  if(m1[i]==0):\n   for j in range(c,m+1):\n    if(l[j]>0):\n     m1[i]=j\n     l[j]-=1\n     c=j\n     break\n print(s)\n print(*m1)\n", "t=int(input())\nfor i in range(t):\n n,m=list(map(int,input().split()))\n l=[0]+list(map(int,input().split()))\n s=0\n c=1\n m1=[]\n for i in range(n):\n  d,f,b=list(map(int,input().split()))\n  if(l[d]>0):\n   m1.append(d)\n   s+=f\n   l[d]-=1\n  else:\n   m1.append(0)\n   s+=b\n for i in range(n):\n  if(m1[i]==0):\n   for j in range(c,m+1):\n    if(l[j]>0):\n     m1[i]=j\n     l[j]-=1\n     c=j\n     break\n print(s)\n print(*m1)\n", "# cook your dish here\nfor _ in range(int(input())):\n n,m=list(map(int, input().split()))\n c=list(map(int, input().split()))\n l=[0]*n \n total=0\n \n for i in range(n):\n  d,f,b=list(map(int, input().split()))\n  if c[d-1]>0:\n   c[d-1]-=1 \n   total+=f \n   l[i]=d \n   \n  else:\n   total+=b \n\n t=m-1 \n print(total) \n for i in l:\n  if i>0:\n   print(i, end=' ')\n   \n  else:\n   while True:\n    if c[t]>0:\n     print(t+1, end=' ')\n     c[t]-=1\n     if c[t]==0:\n      t-=1 \n     break\n    \n    else:\n     t-=1 \n   \n print('') ", "# cook your dish here\nfor _ in range(int(input())):\n n,m=list(map(int, input().split()))\n c=list(map(int, input().split()))\n l = []\n l1=[0]*n \n total=0\n \n for i in range(n):\n  d,f,b=list(map(int, input().split()))\n  if c[d-1]>0:\n   c[d-1]-=1 \n   total+=f \n   l1[i]=d \n   \n  else:\n   total+=b \n   l.append(b)\n \n t=m-1 \n print(total) \n for i in l1:\n  if i>0:\n   print(i, end=' ')\n   \n  else:\n   while True:\n    if c[t]>0:\n     print(t+1, end=' ')\n     c[t]-=1\n     if c[t]==0:\n      t-=1 \n     break\n    \n    else:\n     t-=1 \n   \n print('') ", "t=int(input())\nfor i in range(t):\n n,m=list(map(int,input().split()))\n l=[0]+list(map(int,input().split()))\n s=0\n c=0\n m1=[]\n for i in range(n):\n  d,f,b=list(map(int,input().split()))\n  if(l[d]>0):\n   m1.append(d)\n   s+=f\n   l[d]-=1\n  else:\n   m1.append(0)\n   s+=b\n for i in range(n):\n  if(m1[i]==0):\n   for j in range(c,m+1):\n    if(l[j]>0):\n     m1[i]=j\n     l[j]-=1\n     c=j\n     break\n print(s)\n print(*m1)\n \n    \n   \n  \n \n \n", "t = int(input())\nfor _ in range(t):\n n,m = map(int,input().split())\n flav = list(map(int,input().split()))\n ans = []\n res = 0\n k = 0\n for i in range(n):\n  d,f,b = map(int,input().split())\n  if flav[d-1] == 0:\n   res += b\n   ans.append(-1)\n   k+=1\n  else:\n   flav[d-1]-=1\n   res += f\n   ans.append(d)\n l = []\n for i in range(m):\n  while flav[i]!=0 and k!=0:\n   flav[i]-=1;\n   k-=1\n   l.append(i+1)\n \n print(res)\n c = 0\n for i in range(n):\n  if ans[i] == -1:\n   print(l[c],end =' ')\n   c+=1\n  else:\n   print(ans[i],end=' ')\n print()", "for _ in range(int(input())):\n \n n, m = list(map(int,input().split()))\n \n l= list(map(int,input().split()))\n \n k=[0]*n\n ans=0\n \n for i in range(n):\n  \n  d,f,b = list(map(int,input().split()))\n  \n  if l[d-1]!=0:\n   l[d-1]-=1\n   k[i]=d\n   ans+=f\n  else:\n   ans+=b\n j=0 \n for i in range(m):\n  \n  if l[i]!=0:\n   \n   while(j<n and l[i]>0):\n    \n    if k[j]==0:\n     l[i]-=1\n     k[j]=i+1\n    j+=1\n    \n print(ans)\n print(*k)\n   \n   \n   \n   \n", "for _ in range(int(input())):\n \n n, m = list(map(int,input().split()))\n \n l= list(map(int,input().split()))\n \n k=[0]*n\n ans=0\n \n for i in range(n):\n  \n  d,f,b = list(map(int,input().split()))\n  \n  if l[d-1]!=0:\n   l[d-1]-=1\n   k[i]=d\n   ans+=f\n  else:\n   ans+=b\n j=0 \n for i in range(m):\n  \n  if l[i]!=0:\n   \n   while(j<n and l[i]>0):\n    \n    if k[j]==0:\n     l[i]-=1\n     k[j]=i+1\n    j+=1\n    \n print(ans)\n print(*k)\n     \n    \n   \n   \n   \n   \n   \n   \n   \n   \n   \n   \n", "for _ in range(int(input())):\n \n n, m = list(map(int,input().split()))\n \n l= list(map(int,input().split()))\n \n k=[0]*n\n ans=0\n \n for i in range(n):\n  \n  d,f,b = list(map(int,input().split()))\n  \n  if l[d-1]!=0:\n   l[d-1]-=1\n   k[i]=d\n   ans+=f\n  else:\n   ans+=b\n j=0 \n for i in range(m):\n  \n  if l[i]!=0:\n   \n   while(j<n and l[i]>0):\n    \n    if k[j]==0:\n     l[i]-=1\n     k[j]=i+1\n    j+=1\n    \n print(ans)\n print(*k)\n     \n    \n   \n   \n   \n   \n   \n   \n   \n   \n   \n   \n   \n   \n", "for _ in range(int(input())):\n \n n, m = list(map(int,input().split()))\n \n l= list(map(int,input().split()))\n \n k=[0]*n\n ans=0\n \n for i in range(n):\n  \n  d,f,b = list(map(int,input().split()))\n  \n  if l[d-1]!=0:\n   l[d-1]-=1\n   k[i]=d\n   ans+=f\n  else:\n   ans+=b\n j=0 \n for i in range(m):\n  \n  if l[i]!=0:\n   \n   while(j<n and l[i]>0):\n    \n    if k[j]==0:\n     l[i]-=1\n     k[j]=i+1\n    j+=1\n    \n print(ans)\n print(*k)\n     \n    \n   \n   \n   \n   \n   \n   \n   \n   \n   \n   \n   \n   \n   \n", "for _ in range(int(input())):\n n,m=map(int,input().split())\n drinks=list(map(int,input().split()))\n output=0\n remain=[]\n olist=[0]*n \n for i in range(n):\n  demand,goodp,badp=map(int,input().split())\n  if drinks[demand-1]!=0:\n   drinks[demand-1]-= 1 \n   olist[i]=demand \n   output+=goodp \n  else:\n   remain.append(i)\n   output+=badp \n rj=0\n for i in range(len(drinks)):\n  if drinks[i]==0:\n   continue\n  while(drinks[i]>0):\n   if rj==len(remain):\n    break\n   olist[remain[rj]]=i+1\n   rj+=1 \n   drinks[i]-=1\n  if rj==len(remain):\n   break\n \n print(output)\n for i in olist:\n  print(i,end=\" \")\n print()", "# cook your dish here\nfor _ in range(int(input())):\n n,m=list(map(int,input().split()))\n c=list(map(int,input().split()))\n d={}\n for i in range(len(c)):\n  d[i+1]=c[i]\n ans=[]\n profit=0\n r_1=0\n for i in range(n):\n  t_1,t_2,t_3=list(map(int,input().split()))\n  if d[t_1]>0:\n   profit+=t_2\n   d[t_1]-=1\n   ans.append(t_1)\n  else:\n   profit+=t_3\n   r_1+=1\n   ans.append('')\n print(profit)\n rem=[]\n for i in d:\n  if d[i]>0:\n   rem+=[i]*d[i]\n   d[i]=0\n  if len(rem)>=r_1:\n   break\n j=0\n for i in range(len(ans)):\n  if ans[i]=='':\n   ans[i]=rem[j]\n   j+=1\n print(*ans)\n", "for _ in range(int(input())):\n n,m=list(map(int,input().split()))\n c=list(map(int,input().split()))\n d={}\n for i in range(len(c)):\n  d[i+1]=c[i]\n ans=[]\n profit=0\n r_1=0\n for i in range(n):\n  t_1,t_2,t_3=list(map(int,input().split()))\n  if d[t_1]>0:\n   profit+=t_2\n   d[t_1]-=1\n   ans.append(t_1)\n  else:\n   profit+=t_3\n   r_1+=1\n   ans.append('')\n print(profit)\n rem=[]\n for i in d:\n  if d[i]>0:\n   rem+=[i]*d[i]\n   d[i]=0\n  if len(rem)>=r_1:\n   break\n j=0\n for i in range(len(ans)):\n  if ans[i]=='':\n   ans[i]=rem[j]\n   j+=1\n print(*ans)\n", "t=int(input())\nwhile(t>0):\n n,k=list(map(int,input().split()))\n l=[0]+list(map(int,input().split()))\n s=0\n m=[]\n for i in range(n):\n  d,f,b=list(map(int,input().split()))\n  if(l[d]>0):\n   l[d]-=1\n   s+=f\n   m.append(d)\n  else:\n   s+=b\n   m.append(0)\n c=0\n for i in range(n):\n  if(m[i]==0):\n   for j in range(c,k+1):\n    if(l[j]>0):\n     c=j\n     m[i]=j\n     l[j]-=1\n     break\n print(s) \n print(*m)\n t-=1\n", "for _ in range(int(input())):\n n,m=map(int,input().split())\n c=list(map(int,input().split()))\n l=[]\n ans=0\n for z in range(n):\n  d,f,b=map(int,input().split())\n  l.append([d,f,b])\n v=[0]*len(l)\n res=[0]*n\n a=[]\n for j,i in enumerate(l):\n  if(c[i[0]-1]>0):\n   c[i[0]-1]-=1 \n   ans+=i[1]\n   v[j]=1\n   res[j]=i[0]\n s=len(l)\n lc=len(c)\n count=0\n for i in range(s):\n  if(v[i]==0):\n   ans+=l[i][2]\n   count+=1 \n k=[]\n for i in range(lc):\n  if(c[i]>0):\n   while(c[i]>0 and count>0):\n    c[i]-=1 \n    count-=1 \n    k.append(i+1)\n kl=len(res)\n for i in range(kl):\n  if(res[i]==0):\n   res[i]=k.pop()\n print(ans) \n for i in res:\n  print(i,end=' ')\n print()", "for _ in range(int(input())):\n n,m=map(int,input().split())\n c=list(map(int,input().split()))\n l=[]\n ans=0\n for z in range(n):\n  d,f,b=map(int,input().split())\n  l.append([d,f,b])\n v=[0]*len(l)\n res=[0]*n\n a=[]\n for j,i in enumerate(l):\n  if(c[i[0]-1]>0):\n   c[i[0]-1]-=1 \n   ans+=i[1]\n   v[j]=1\n   res[j]=i[0]\n s=len(l)\n lc=len(c)\n count=0\n for i in range(s):\n  if(v[i]==0):\n   ans+=l[i][2]\n   count+=1 \n k=[]\n for i in range(lc):\n  if(c[i]>0):\n   while(c[i]>0 and count>0):\n    c[i]-=1 \n    count-=1 \n    k.append(i+1)\n kl=len(res)\n for i in range(kl):\n  if(res[i]==0):\n   res[i]=k.pop()\n print(ans) \n for i in res:\n  print(i,end=' ')\n print()", "# cook your dish here\ntest=int(input())\nfor _ in range(test):\n n,m=map(int,input().split(\" \"))\n c=[int(j) for j in input().split(\" \")]\n revenue=0\n finallist=[]\n remlist=[]\n p=0\n customer=[]\n for j in range(n):\n  customer.append([int(j) for j in input().split(\" \")])\n  if c[customer[j][0]-1]>0:\n   revenue += customer[j][1]\n   finallist.append(customer[j][0])\n   c[customer[j][0]-1]-=1\n  else:\n   remlist.append(p)\n  p+=1\n\n k=0\n while len(remlist):\n  if c[k]>0:\n   revenue+=customer[remlist[0]][2]\n   finallist.insert(remlist[0],k+1)\n   c[k]-=1\n   remlist.remove(remlist[0])\n  else:\n   k+=1\n print(revenue)\n print(*finallist, sep = \" \")", "t=int(input())\nfor i in range(t):\n # n = number of customers, m = number of flavors\n n , m = map(int,input().split(\" \"))\n # c for number of each flavor\n c = [int(j) for j in input().split(\" \")]\n # customer for customer preference data\n\n revenue = 0\n finallist = []\n remlist = []\n p=0\n\n customer = []\n for j in range(n):\n  customer.append([int(j) for j in input().split(\" \")])\n  if c[customer[j][0]-1]>0:\n   revenue += customer[j][1]\n   finallist.append(customer[j][0])\n   c[customer[j][0]-1]-=1\n  else:\n   remlist.append(p)\n  p+=1\n\n k=0\n while len(remlist):\n  if c[k]>0:\n   revenue += customer[remlist[0]][2]\n   finallist.insert(remlist[0],k+1)\n   c[k]-=1\n   remlist.remove(remlist[0])\n  else:\n   k+=1\n     \n print(revenue)\n print(*finallist, sep = \" \")", "# cook your dish here\nfor _ in range(int(input())):\n n,m=map(int,input().split())\n l=[0]*(m+1)\n assign=[0]*(n+1)\n s=0\n k=list(map(int,input().split()))\n for i in range(m):\n  l[i+1]=k[i]\n for i in range(n):\n  d,f,b=map(int,input().split())\n  if(l[d]>0):\n   l[d]-=1\n   s+=f\n   assign[i]=d\n  else:\n   s+=b\n j=0\n while(l[j]==0):\n  j+=1\n for i in range(n):\n  if(assign[i]==0):\n   if(l[j]!=0):\n    l[j]-=1\n    assign[i]=j\n   else:\n    while(l[j]==0):\n     j+=1\n    l[j]-=1\n    assign[i]=j\n print(s)\n for i in range(n):\n  print(assign[i],end=\" \")\n print()\n  ", "t=int(input())\nfor i in range(t):\n n,m=[int(x) for x in input().split()]\n arr=[]\n amt=[int(x) for x in input().split()]\n cost=0\n brr=[0 for i in range(n)]\n for j in range(n):\n  arr.append([int(y) for y in input().split()])\n  if(amt[arr[j][0]-1]>0):\n   amt[arr[j][0]-1]-=1\n   cost+=arr[j][1]\n   brr[j]=arr[j][0]\n r=0\n for j in range(n):\n  if(brr[j]==0):\n   for k in range(r,m):\n    if(amt[k]>0):\n     r=k\n     amt[k]-=1\n     cost+=arr[j][2]\n     brr[j]=k+1\n     break\n print(cost)\n for j in range(n-1):\n  print(brr[j],end=\" \")\n print(brr[-1])\n", "t=int(input())\nfor i in range(t):\n n,m=[int(x) for x in input().split()]\n arr=[]\n amt=[int(x) for x in input().split()]\n cost=0\n brr=[0 for i in range(n)]\n for j in range(n):\n  arr.append([int(y) for y in input().split()])\n  if(amt[arr[j][0]-1]>0):\n   amt[arr[j][0]-1]-=1\n   cost+=arr[j][1]\n   brr[j]=arr[j][0]\n r=0\n for j in range(n):\n  if(brr[j]==0):\n   for k in range(r,m):\n    if(amt[k]>0):\n     r=k\n     amt[k]-=1\n     cost+=arr[j][2]\n     brr[j]=k+1\n     break\n print(cost)\n for j in range(n-1):\n  print(brr[j],end=\" \")\n print(brr[-1])\n", "t=int(input())\nfor i in range(t):\n n,m=[int(x) for x in input().split()]\n amt=[int(x) for x in input().split()]\n cost=0\n brr=[0 for x in range(n)]\n crr=[]\n for j in range(n):\n  d,f,b=[int(x) for x in input().split()]\n  if(amt[d-1]>0):\n   amt[d-1]-=1\n   cost+=f\n   brr[j]=d\n  else:\n   crr.append(j)\n   cost+=b\n r=0\n for j in crr:\n  for k in range(r,m):\n   if(amt[k]>0):\n    r=k\n    amt[k]-=1\n    brr[j]=k+1\n    break\n print(cost)\n for j in range(n-1):\n  print(brr[j],end=\" \")\n print(brr[-1])\n", "t=int(input())\nfor i in range(t):\n d=[]\n f=[]\n b=[]\n profit=0\n \n n,m=[int(x) for x in input().split()]\n\n order=[0 for j in range(n)]\n flav=[int(x) for x in input().split()]\n for j in range(n):\n  inp=[int(x) for x in input().split()]\n  d.append(inp[0])\n  f.append(inp[1])\n  b.append(inp[2])\n\n for j in range(n):\n  if(flav[d[j]-1])>0:\n   profit=profit+f[j]\n   flav[d[j]-1]-=1\n   order[j]=d[j]\n flag=0\n for j in range(n):\n  if(order[j]==0):\n   for k in range(flag,n):\n    if(flav[flag]>0):\n     order[j]=flag+1\n     flav[flag]-=1\n     profit+=b[j]\n     break\n    else:\n     flag+=1\n\n print(profit)\n for k in range(len(order)-1):\n  print(order[k],end=\" \")\n print(order[-1])\n"]