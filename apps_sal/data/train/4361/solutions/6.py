K_PERMS = {2: [144, 256, 441, 625, 1369, 1764, 1936, 4761, 11236, 12769, 14884, 21316, 24649, 24964, 27556, 29584, 34596, 36864, 43264, 45369, 46656, 48841, 51984, 54289, 66564, 74529, 75625, 79524, 86436, 95481, 96721, 99856, 112225, 113569, 118336, 133956, 139876, 142884, 147456, 148225, 148996, 154449, 155236, 166464, 167281, 169744, 173889, 174724, 175561, 194481, 198916, 212521, 216225, 224676, 225625, 227529, 233289, 237169, 238144, 264196, 265225, 267289, 272484, 287296, 293764, 314721, 316969, 323761, 328329, 329476, 344569, 345744, 355216, 368449, 369664, 374544, 383161, 391876, 398161, 427716, 432964, 434281, 447561, 456976, 459684, 463761, 467856, 474721, 498436, 521284, 522729, 546121, 591361, 594441, 611524, 619369, 622521, 627264, 646416, 649636, 654481, 659344, 667489, 669124, 675684, 678976, 712336, 729316, 736164, 741321, 748225, 755161, 758641, 769129, 772641, 779689, 781456, 786769, 793881, 795664, 799236, 817216, 835396, 842724, 844561, 848241, 874225, 877969, 891136, 894916, 919681, 927369, 933156, 948676, 956484, 964324, 972196, 976144, 9114361], 3: [961, 9216, 11664, 12544, 16641, 18225, 23716, 25281, 32761, 41616, 42849, 44521, 49284, 52441, 72361, 81225, 82944, 131769, 141376, 149769, 164836, 165649, 197136, 319225, 349281, 364816, 378225, 381924, 417316, 471969, 481636, 541696, 837225, 931225, 974169, 7112889], 4: [81796, 112896, 132496, 168921, 195364, 214369, 269361, 298116, 346921, 395641, 436921, 543169, 962361, 4511376], 5: [43681, 6395841], 6: [7241481], 7: [4532641]}


def next_perfectsq_perm(lower_limit, k, answer=0):
    for number in K_PERMS[k]:
        if not answer and number > lower_limit:
            answer = number
        elif answer and sorted(str(number)) == sorted(str(answer)):
            answer = number
    return answer
