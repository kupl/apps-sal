["m= 1000000007\ndef mul(a,b):\n return [(a[0]*b[0]+a[1]*b[2])%m,\n   (a[0]*b[1]+a[1]*b[3])%m,\n   (a[2]*b[0]+a[3]*b[2])%m,\n   (a[2]*b[1]+a[3]*b[3])%m] \ndef f(n):\n if n==0:\n  return 0\n v1, v2, v3 = 1, 1, 0 \n for rec in bin(n)[3:]:\n  v2=v2%m\n  v1=v1%m\n  v3=v3%m\n  calc = (v2*v2)\n  v1, v2, v3 = (v1*v1+calc), ((v1+v3)*v2), (calc+v3*v3)\n  if rec=='1': v1, v2, v3 = v1+v2, v1, v2\n return [v1+1,v2,v2,v3+1]\n\ndef q(X,Y):\n nonlocal A\n s = [1,0,0,1]\n for v in A[X-1:Y]:\n  s = mul(s,f(v))\n return s[1]%m\n\nN,M = list(map(int,input().split()))\nA=list(map(int,input().split()))\nfor _ in range(M):\n [T,X,Y] = input().split()\n X,Y = int(X),int(Y)\n if T=='Q':\n  print(q(X,Y))\n else:\n  A[X-1]=Y"]