["def f(a,n):\n    l,r,s1,s2 = [0]*n, [0]*n, [], []\n \n    for i in range(n):\n     count = 1\n     while(len(s1)>0 and a[i]<s1[-1][0]):\n      count += s1[-1][1]\n      s1.pop()\n     s1.append((a[i],count))\n     l[i] = count\n \n    for i in range(n-1,-1,-1):\n     count = 1\n     while(len(s2)>0 and a[i]<=s2[-1][0]):\n      count += s2[-1][1]\n      s2.pop()\n     s2.append((a[i],count))\n     r[i] = count\n \n    count = 0\n    for i in range(n):\n     count += a[i]*l[i]*r[i]\n \n    return count\n\nt = int(input())"]