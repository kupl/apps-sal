["mod = 998244353\nf0 = [ [0 for i in range(11)] for j in range(2010) ]\nf1 = [ [0 for i in range(11)] for j in range(2010) ]\nfac = [0 for i in range(2010)]\ntab = [0 for i in range(11)]\nC = [ [0 for i in range(2010)] for j in range(2010) ]\n\ndef Init() :\n    fac[0] = 1\n    for i in range(2010) :\n        if i > 0 : fac[i] = fac[i - 1] * i % mod\n        C[i][0] = 1\n        for j in range(1, 2010) :\n            C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % mod\n\ndef len(x) :\n    res = 0\n    while x > 0 :\n        res += 1\n        x = x // 10\n    return res\n            \ndef solve() :\n    n = int(input())\n    f0[0][0] = f1[0][0] = 1\n    a = list(map(int, input().split()))\n    c0, c1 = 0, 0\n    s0, s1 = 0, 0\n    for nu in a :\n        m = nu % 11\n        if len(nu) & 1 :\n            c1 += 1\n            s1 += m\n            for i in range(11) :\n                f1[c1][i] = 0\n            for i in range(c1 - 1, -1, -1) :\n                for j in range(11) :\n                    if f1[i][j] == 0 : continue\n                    f1[i + 1][(j + m) % 11] += f1[i][j]\n                    f1[i + 1][(j + m) % 11] %= mod\n        else :\n            c0 += 1\n            s0 += m\n            for i in range(11) :\n                f0[c0][i] = 0\n            for i in range(c0 - 1, -1, -1) :\n                for j in range(11) :\n                    if f0[i][j] == 0 : continue\n                    f0[i + 1][(j + m) % 11] += f0[i][j]\n                    f0[i + 1][(j + m) % 11] %= mod\n    s1 %= 11\n    s0 %= 11\n    part = c1 // 2\n    for i in range(11) :\n        tab[i] = 0\n    for i in range(11) :\n        tab[(i + i + 11 - s1) % 11] = f1[c1 - part][i]\n    for i in range(11) :\n        tab[i] = tab[i] * fac[part] % mod * fac[c1 - part] % mod\n\n    ans = 0\n    if c1 == 0 :\n        ans = f0[c0][0] * fac[c0]\n    elif c0 == 0 :\n        ans = tab[0]\n    else :\n        for i in range(c0 + 1) :\n            for j in range(11) :\n                if f0[i][j] == 0 : continue\n                # print(f0[i][j], tab[(j + j + 11 - s0) % 11] \\\n                # , fac[i] % mod * fac[c0 - i] % mod, C[j + (c1 - part) - 1][(c1 - part) - 1] % mod * C[part + c0 - i][part] % mod )\n                ans = ( ans \\\n                        + fac[i] % mod * fac[c0 - i] % mod \\\n                        * f0[i][j] * tab[(j + j + 11 - s0) % 11] % mod \\\n                        * C[i + (c1 - part) - 1][(c1 - part) - 1] % mod \\\n                        * C[part + c0 - i][part]\n ) % mod\n    print(ans)\n\nInit()\nT = int(input())\nfor ttt in range(T) : solve()"]