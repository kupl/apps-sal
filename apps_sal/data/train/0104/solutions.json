["from sys import stdin\ninput = stdin.readline\nq = int(input())\nfor rwerew in range(q):\n\tn = int(input())\n\tp = list(map(int,input().split()))\n\tc = list(map(int,input().split()))\n\tfor i in range(n):\n\t\tp[i] -= 1\n\tprzyn = [0] * n\n\tgrupa = []\n\ti = 0\n\twhile i < n:\n\t\tif przyn[i] == 1:\n\t\t\ti += 1\n\t\telse:\n\t\t\tnowa_grupa = [i]\n\t\t\tj = p[i]\n\t\t\tprzyn[i] = 1\n\t\t\twhile j != i:\n\t\t\t\tprzyn[j] = 1\n\t\t\t\tnowa_grupa.append(j)\n\t\t\t\tj = p[j]\n\t\t\tgrupa.append(nowa_grupa)\n\tgrupacol = []\n\tfor i in grupa:\n\t\tcyk = []\n\t\tfor j in i:\n\t\t\tcyk.append(c[j])\n\t\tgrupacol.append(cyk)\n\t#print(grupacol)\n\tmini = 234283742834\n\tfor cykl in grupacol:\n\t\tdziel = []\n\t\td =  1\n\t\twhile d**2 <= len(cykl):\n\t\t\tif len(cykl)%d == 0:\n\t\t\t\tdziel.append(d)\n\t\t\td += 1\n\t\tdodat = []\n\t\tfor d in dziel:\n\t\t\tdodat.append(len(cykl)/d)\n\t\tdziel_ost = list(map(int,dziel + dodat))\n\t\t#print(dziel_ost, len(cykl))\n\t\tfor dzielnik in dziel_ost:\n\t\t\tfor i in range(dzielnik):\n\t\t\t\tindeks = i\n\t\t\t\tsecik = set()\n\t\t\t\tchuj = True\n\t\t\t\twhile indeks < len(cykl):\n\t\t\t\t\tsecik.add(cykl[indeks])\n\t\t\t\t\tindeks += dzielnik\n\t\t\t\t\tif len(secik) > 1:\n\t\t\t\t\t\tchuj = False\n\t\t\t\t\t\tbreak\n\t\t\t\tif chuj:\n\t\t\t\t\tmini = min(mini, dzielnik)\n\tprint(mini)\n\t\t\t\n", "T = int(input())\nfor _ in range(T):\n    n = int(input())\n    perm = list([int(x) - 1 for x in input().split()])\n    color = list(map(int, input().split()))\n\n    SMALL = n\n\n    unseen = set(range(n))\n    while unseen:\n        start = unseen.pop()\n        l = [start]\n        nex = start\n        while perm[nex] != start:\n            nex = perm[nex]\n            l.append(nex)\n            unseen.remove(nex)\n\n        size = len(l)\n        factors = []\n\n        curr = 1\n        while curr * curr <= size:\n            if size % curr == 0:\n                factors.append(curr)\n                factors.append(size//curr)\n            curr += 1\n\n        for f in factors:\n            works = [True] * f\n            for i in range(size):\n                if color[l[i]] != color[l[i % f]]:\n                    works[i % f] = False\n\n            for b in works:\n                if b:\n                    SMALL = min(SMALL, f)\n                    break\n\n    print(SMALL)\n        \n", "import sys\n\nT = int(sys.stdin.readline().strip())\nQ = []\nP = [0] * (10 ** 6)\nfor i in range (2, 2 * 10 ** 5 + 10):\n    v = True\n    if P[i] == 0:\n        Q.append(i)\n        j = i\n        while j < 10 ** 6:\n            P[j] = 1\n            j = j + i\n\ndef factors(n):\n    i2 = 0\n    ans = [1]\n    while n > 1:\n        m = 0\n        while n % Q[i2] == 0:\n            m = m + 1\n            n = n // Q[i2]\n        ans2 = []\n        for h in range (0, m+1):\n            for j in ans:\n                ans2.append(j * (Q[i2] ** h))\n        i2 = i2 + 1\n        ans = ans2[:]\n    return ans\n\nfor t in range (0, T):\n    n = int(sys.stdin.readline())\n    p = list(map(int, sys.stdin.readline().strip().split()))\n    c = list(map(int, sys.stdin.readline().strip().split()))\n    for i in range (0, n):\n        p[i] = p[i] - 1\n    P = []\n    L = []\n    i = 0\n    ans = n\n    while i < n:\n        if p[i] == -1:\n            i = i + 1\n        else:\n            j = i\n            x = [j]\n            while p[j] != i:\n                x.append(p[j])\n                j2 = p[j]\n                p[j] = -1\n                j = j2\n            p[j] = -1\n            P.append(x)\n            l = len(x)\n            F = factors(l)\n            for f in F:\n                for j in range (0, f):\n                    v = True\n                    for h in range (0, l // f):\n                        if c[x[j + h * f]] != c[x[j]]:\n                            v = False\n                    if v == True:\n                        ans = min(ans, f)   \n    print(ans)\n\n", "import sys\ninput = lambda: sys.stdin.readline().rstrip()\n\ndef primeFactor(N):\n    i, n, ret, d, sq = 2, N, {}, 2, 99\n    while i <= sq:\n        k = 0\n        while n % i == 0: n, k, ret[i] = n//i, k+1, k+1\n        if k > 0 or i == 97: sq = int(n**(1/2)+0.5)\n        if i < 4: i = i * 2 - 1\n        else: i, d = i+d, d^6\n    if n > 1: ret[n] = 1\n    return ret\n\ndef divisors(N):\n    pf = primeFactor(N)\n    ret = [1]\n    for p in pf:\n        ret_prev = ret\n        ret = []\n        for i in range(pf[p]+1):\n            for r in ret_prev:\n                ret.append(r * (p ** i))\n    return sorted(ret)\n\ndef chk(X):\n    n = len(X)\n    XX = X * 2\n    mi = 1 << 30\n    for d in divisors(n):\n        if d >= mi: break\n        for i in range(d):\n            for j in range(i, n+i, d):\n                if XX[j] != XX[j+d]:\n                    break\n            else:\n                mi = min(mi, d)\n    return mi\n\nT = int(input())\nfor _ in range(T):\n    N = int(input())\n    A = [int(a) - 1 for a in input().split()]\n    C = [int(a) - 1 for a in input().split()]\n    done = [0] * N\n    L = []\n    for i in range(N):\n        if done[i]: continue\n        t = [C[i]]\n        j = A[i]\n        while j != i:\n            t.append(C[j])\n            done[j] = 1\n            j = A[j]\n        L.append(t)\n    print(min([chk(a) for a in L]))\n", "import sys\n\n\n\ndef bestval(pp, cc):\n    # print(\"BESTVAL:\")\n    # print(pp)\n    # print(cc)\n    k = len(pp)\n    k_2 = k//2+1\n    for f in range(1, k_2):\n        if k % f == 0:\n            for offs in range(f):\n                \n                good = True\n                num = cc[offs]\n                # print(f\"{f}, {offs}, {num}: \")\n                upp = (k//f)//2+1\n                for j in range(1, upp):\n                    v1 = f*j \n                    v2 = k - v1 + offs\n                    v1 += offs\n                    # print(pp[v1], pp[v2])\n                    if cc[v1] != num or cc[v2] != num:\n                        good = False\n                        break\n                if good:\n                    return f\n    return k\n\n\n\nfor q in range(int(sys.stdin.readline())):\n    n = int(sys.stdin.readline())\n    p = [int(j)-1 for j  in sys.stdin.readline().split()]\n    c = [int(j)-1 for j  in sys.stdin.readline().split()]\n    fnd = [0]*n\n    ans = n+1\n    for i in range(n):\n        if not fnd[i]:\n            ppp = [i]\n            ccc = [c[i]]\n            fnd[i] = 1\n            j = p[i]\n            while j != i:\n                fnd[j] = 1\n                ppp.append(j)\n                ccc.append(c[j])\n                j = p[j]\n            # bb = \n            # print(bb)\n            ans = min(ans, bestval(ppp, ccc))\n    sys.stdout.write(str(ans) + '\\n')"]