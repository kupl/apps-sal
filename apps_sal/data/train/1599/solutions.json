["'''input\n1\n3\n1 2\n1 3\n1 2 3\n'''\nimport sys\nsys.setrecursionlimit(1000000)\nfor _ in range(eval(input())):\n C=[]\n n=eval(input())\n for i in range(n):\n  C.append([])\n for i in range(n-1):\n  a,b=[int(x)-1 for x in input().split()]\n  C[a].append(b)\n  C[b].append(a)\n cnt=0\n Co=[bin(int(x)).count(\"1\") for x in input().split()]\n Q=[0]*(n+100)\n cur=0\n done=[0]*n\n done[0]=1\n H=[0]*n\n for i in range(n):\n  r=Q[i]\n  if H[r]&1 == Co[r]&1:\n   cnt+=1\n  for i in C[r]:\n   if done[i]==0:\n    done[i]=1\n    Q[cur+1]=i\n    cur+=1\n    H[i]=H[r]+1\n #dfs(0,-1)\n print(cnt*(n-cnt))\n\n"]