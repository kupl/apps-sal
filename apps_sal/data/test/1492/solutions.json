["import sys\ninput = lambda:sys.stdin.readline().rstrip()\n\nh,w=map(int,input().split())\nd=w+2\nb=[0]*(w+2)\nfor i in range(h):\n  b+=([0]+[int(j==\"X\") for j in input()]+[0])\nb+=([0]*(w+2))\nco=sum(b)\nt=10**10\nfor i in range(1,h+1):\n  f=0\n  for j in range(w+2):\n    f+=b[i*d+j]\n    if b[i*d+j]==0 and f:\n      t=min(t,(f-1)//2)\n      f=0\nfor j in range(1,w+1):\n  f=0\n  for i in range(h+2):\n    f+=b[i*d+j]\n    if b[i*d+j]==0 and f:\n      t=min(t,(f-1)//2)\n      f=0\n\ncoo=0\nans=[-1]*(w+2)*(h+2)\nstack=[]\nfor i in range(h+2):\n  for j in range(w+2):\n    if b[i*d+j]==0:\n      stack.append(i*d+j)\n      ans[i*d+j]=0\ndij=[(-1,-1),(-1,0),(-1,1),(0,-1),(0,1),(1,-1),(1,0),(1,1)]\nfor ij in stack:\n  i,j=divmod(ij,d)\n  for x,y in dij:\n    if 0<=i+x<h+2 and 0<=j+y<w+2:\n      if ans[(i+x)*d+j+y]==-1:\n        ans[(i+x)*d+j+y]=ans[i*d+j]+1\n        if ans[(i+x)*d+j+y]>t:\n          coo+=1\n        stack.append((i+x)*d+(j+y))\nif coo*6<co and t==1:\n  t-=1\nprint(t)\nfor i in range(1,h+1):\n  print(\"\".join([\".X\"[int(t<j)]for j in ans[i*d+1:i*d+w+1]]))"]