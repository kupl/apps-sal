["from collections import defaultdict\nn, m = list(map(int, input().split()))\ndata = defaultdict(dict)\n\nfor _ in range(n):\n    name, region, score = input().split()\n    region = int(region)\n    score = int(score)\n    if region not in data:\n        data[region] = defaultdict(list)\n\n    data[region][score].append(name)\n\nfor r in range(1, m + 1):\n    scores = data[r]\n    score_list = list(scores)\n    score_list.sort()\n    best = score_list[-1]\n    if len(scores[best]) > 2:\n        print('?')\n    elif len(scores[best]) == 1:\n        second = score_list[-2]\n        if len(scores[second]) >= 2:\n            print('?')\n        else:\n            name1 = scores[best][0]\n            name2 = scores[second][0]\n            print(name1, name2)\n    else:\n        print(' '.join(scores[best]))\n", "#!/usr/bin/env python3\n\ntry:\n    while True:\n        n, m = list(map(int, input().split()))\n        d = [[ ] for i in range(m)]\n        for i in range(n):\n            name, region, score = input().split()\n            region = int(region) - 1\n            score = int(score)\n            d[region].append((score, name))\n        for i in range(m):\n            ls = d[i]\n            ls.sort(reverse=True)\n            if len(ls) > 2 and ls[1][0] == ls[2][0]:\n                print('?')\n            else:\n                print(ls[0][1], ls[1][1])\n\nexcept EOFError:\n    pass\n", "\nn, m = list(map(int, input().split()))\n\nregions = [[] for i in range(m)]\n\nfor i in range(n):\n    name, region, score = input().split()\n    region = int(region)\n    score = int(score)\n    regions[region - 1] += [(score, name)]\n\nfor i in range(m):\n    regions[i] = sorted(regions[i])\n\n\nfor i in range(m):\n    if len(regions[i]) > 2 and \\\n       regions[i][-2][0] == regions[i][-3][0]:\n        print(\"?\")\n    else:\n        print(regions[i][-1][1] + \" \" + regions[i][-2][1])\n\n\n\n\n\n\n\n", "3\n\nclass StdIO:\n\tdef read_int(self):\n\t\treturn int(self.read_string())\n\n\tdef read_ints(self, sep=None):\n\t\treturn [int(i) for i in self.read_strings(sep)]\n\n\tdef read_float(self):\n\t\treturn float(self.read_string())\n\n\tdef read_floats(self, sep=None):\n\t\treturn [float(i) for i in self.read_strings(sep)]\n\n\tdef read_string(self):\n\t\treturn input()\n\n\tdef read_strings(self, sep=None):\n\t\treturn self.read_string().split(sep)\n\nio = StdIO()\n\n\ndef main():\n\tn, m = io.read_ints()\n\n\tppl = [list() for i in range(m)]\n\n\tfor i in range(n):\n\t\tname, reg, score = io.read_strings()\n\t\treg = int(reg)\n\t\tscore = int(score)\n\t\treg -= 1\n\n\t\tppl[reg].append((score, name))\n\n\tfor reg in range(m):\n\t\tppl[reg].sort(reverse=True)\n\n\t\tteam = ppl[reg]\n\t\tsca = team[0][0]\n\t\tscb = team[1][0]\n\t\tscc = team[2][0] if len(team) > 2 else None\n\n\t\tif scc is None or (sca > scc and scb > scc):\n\t\t\tprint(team[0][1], team[1][1])\n\t\telse:\n\t\t\tprint('?')\n\ndef __starting_point():\n\tmain()\n\n__starting_point()", "n, m = list(map(int, input().split()))\na = []\nfor i in range(m):\n    a.append([])\nfor i in range(n):\n    s, c, b = input().split()\n    c = int(c)\n    b = int(b)\n    a[c - 1].append([-b, s])\nfor i in range(m):\n    a[i].sort()\n    if len(a[i]) == 2:\n        print(a[i][0][1], a[i][1][1])\n    else:\n        aa = a[i][1][0]\n        bb = a[i][2][0]\n        if aa == bb:\n            print('?')\n        else:\n            print(a[i][0][1], a[i][1][1])\n", "#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n\nimport time\n\n(n, m) = (int(i) for i in input().split())\na      = {}\n\nfor i in range(m):\n    a[i] = []\n\nfor i in range(n):\n    (f, r, s)   = (i for i in input().split())\n    r = int(r)-1\n    a[r].append([f, int(s)])\n\nstart = time.time()\nans   = []\n\nfor i in range(m):\n    a[i] = sorted(a[i], key = lambda x: x[1], reverse = True)\n    if (len(a[i]) > 2 ) and (a[i][1][1] == a[i][2][1]):\n        ans.append('?')\n    else:\n        ans.append(a[i][0][0] + \" \" + a[i][1][0])\n\nfor i in range(m):\n    print(ans[i])\nfinish = time.time()\n#print(finish - start)\n", "def solve():\n    N, M = list(map(int, input().split()))\n\n    ds = [[] for _ in range(M)]\n    for i in range(N):\n        name, dn, score = input().split()\n        dn = int(dn) - 1\n        ds[dn].append((-int(score), name))\n\n    for i in range(M):\n        ps = ds[i]\n        ps.sort()\n        if len(ps) == 2:\n            print('%s %s' % (ps[0][1], ps[1][1]))\n        else:\n            if ps[1][0] == ps[2][0]:\n                print('?')\n            else:\n                print('%s %s' % (ps[0][1], ps[1][1]))\n\n\ndef __starting_point():\n    solve()\n\n__starting_point()", "n, m = list(map(int, input().split(' ')))\n\ndef De(s):\n    p = s.split(' ')\n    return p[0], int(p[1]) - 1, int(p[2])\n\nl = [[] for _ in range(m)]\nt = [0] * m\n\nfor _ in range(n):\n    p, r, s = De(input())\n    if len(l[r]) < 1:\n        l[r].append((p, s))\n    elif len(l[r]) < 2:\n        if s > l[r][0][1]:\n            l[r].insert(0, (p, s))\n        else:\n            l[r].append((p, s))\n    elif len(l[r]) < 3:\n        if s > l[r][0][1]:\n            l[r].insert(0, (p, s))\n        elif s > l[r][1][1]:\n            l[r].insert(1, (p, s))\n        else:\n            l[r].append((p, s))\n    else:\n        if s > l[r][0][1]:\n            l[r].insert(0, (p, s))\n        elif s > l[r][1][1]:\n            l[r].insert(1, (p, s))\n        elif s > l[r][2][1]:\n            l[r].insert(2, (p, s))\n        else:\n            l[r].append((p, s))\n        l[r].pop()\n    \n\nfor i in range(m):\n    if len(l[i]) > 2 and l[i][1][1] == l[i][2][1]:\n        print('?')\n    else:\n        print(l[i][0][0], l[i][1][0])\n", "nm =  list(map(int,input().split()))\nlargeDict = {}\nfor i in range(nm[1]):\n    largeDict[i+1] = {}\nfor i in range(nm[0]):\n    tempList = input().split()\n    largeDict[int(tempList[1])][tempList[0]] = int(tempList[2])\nfor i in range(nm[1]):\n    aList = []\n    newDict = {}\n    aList = list(largeDict[i+1].values())\n    aList = sorted(aList)[len(aList)-2:]            \n    for h in list(largeDict[i+1].keys()):\n        if largeDict[i+1][h] in aList:\n            newDict[h] = largeDict[i+1][h]\n    largeDict[i+1] = newDict\n    if len(list(largeDict[i+1].keys())) > 2:\n        print(\"?\")\n    else:\n        print(\" \".join(list(largeDict[i+1].keys())))\n", "class shkolnik():\n    ball = 0\n\nn, m = list(map(int, input().split()))\n\na = []\n\n\ndef ballsort(x):\n    return x.ball\n\n\nfor i in range(m + 1):\n    a.append([])\n\nfor i in range(n):\n    c = shkolnik()\n    c.family, reg, c.ball = input().split()\n    c.ball = int(c.ball)\n    a[int(reg)].append(c)\n\nfor i in range(1, m + 1):\n    a[i].sort(key=ballsort)\n\nfor i in range(1, m + 1):\n    if len(a[i]) > 2 and a[i][-2].ball == a[i][-3].ball:\n        print(\"?\")\n    else:\n        print(a[i][-1].family, a[i][-2].family)\n", "n, m = list(map(int, input().split()))\nb = [[0]*3 for i in range(n)]\nfor i in range(n):\n    b[i][2], b[i][0], b[i][1] = list(map(str, input().split()))\n    b[i][0] = int(b[i][0])\n    b[i][1] = int(b[i][1])\nb.sort()\nj = 0\nfor i in range(m):\n    k = 0\n    while j < n and b[j][0] == i + 1:\n        k += 1   \n        j += 1\n    if k > 2 and b[j - 2][1] == b[j - 3][1]:\n            print('?')\n    elif k > 0:\n        print(b[j-1][2] + ' ' + b[j-2][2])\n", "n,m=list(map(int,input().split()))\nls=[[] for i in range(m) ]\nfor i in range(n):\n    a,b,c=input().split()\n    b,c=int(b),int(c)\n    ls[b-1].append([a,c])\n\nfor i in range(m):\n    ls[i].sort(key=lambda x: x[1],reverse=True)\n    #print(ls[i])\n    if len(ls[i])>2 and ls[i][1][1]==ls[i][2][1]:\n        print(\"?\")\n    else :\n        print(ls[i][0][0],ls[i][1][0])\n", "student_number, regions = map(int, input().split())\ncompetiton_description = dict()\n\nfor _ in range(student_number):\n    surname, region, score = input().split()\n    if int(region) not in competiton_description:\n        competiton_description[int(region)] = [[int(score), surname]]\n    else:\n        competiton_description[int(region)].append([int(score), surname])\n\nfor key, value in sorted(competiton_description.items()):\n    value.sort(key=lambda s: (-s[0], s[1]))\n    #print(value)\n    if len(value) > 2 and value[1][0] == value[2][0]:\n        print('?')\n    else:\n        print(value[0][1], value[1][1])", "n, m = map(int, input().split())\nl = [[] for i in range(m)]\nfor i in range(n):\n    a=input().split()\n    x, y = int(a[1]), int(a[2])\n    l[x-1].append([y, a[0]])\nfor i in range(m):\n    l[i].sort()\n    if len(l[i])>2:\n        if l[i][-2][0]==l[i][-3][0]:\n            print('?')\n        else:\n            print(l[i][-1][1]+' '+l[i][-2][1])\n    else:\n        print(l[i][-1][1]+' '+l[i][-2][1])", "#!/usr/bin/env python3\n\nread_ints = lambda : list(map(int, input().split()))\n\ndef __starting_point():\n    n, m = read_ints()\n    R = [[] for _ in range(m)]\n    for i in range(n):\n        n,r,s = input().split()\n        r = int(r)\n        s = int(s)\n        R[r-1].append((s,n))\n\n    for r in R:\n        r.sort(reverse=True)\n        if len(r) > 2:\n            if r[1][0] == r[2][0]:\n                print(\"?\")\n            else:\n                print(\"%s %s\" % (r[0][1], r[1][1]))\n        else:\n            print(\"%s %s\" % (r[0][1], r[1][1]))\n\n__starting_point()", "string = input().split()\nn = int(string[0])\nm = int(string[1])\nregions = []\nfor i in range(m + 1):\n    regions.append([])\n\nfor i in range(n):\n    string = input().split()\n    reg = int(string[1])\n    name = string[0]\n    points = int(string[2])\n    regions[reg].append((name, points))\n\nfor i in range(1, m + 1):\n    regions[i].sort(key=lambda x: x[1], reverse=True)\n    if len(regions[i]) == 2:\n        print(regions[i][0][0], regions[i][1][0])\n    elif regions[i][1][1] == regions[i][2][1]:\n        print('?')\n    else:\n        print(regions[i][0][0], regions[i][1][0])\n", "n, m = list(map(int, input().split()))\na = [[] for i in range(m)]\nfor i in range(n):\n    x = input().split()\n    a[int(x[1]) - 1].append([int(x[2]), x[0]])\nfor i in range(m):\n    x = sorted(a[i], reverse=True)\n    if len(x) == 2:\n        print(' '.join([x[0][1], x[1][1]]))\n        continue\n    if x[1][0] > x[2][0]:\n        print(' '.join([x[0][1], x[1][1]]))\n    else:\n        print('?')\n", "\ndef f(x):\n    return x[1]\nL = [int(s) for s in input().split()]\nn,m = L[0], L[1]\nResult = [[] for i in range(m)]\n\nfor i in range(n):\n    Name = [s for s in input().split()]\n    region = int(Name[1]) - 1\n    Result[region].append([Name[0],int(Name[2])])\nfor i in range(m):\n    R = []\n    X = sorted(Result[i],key = f)[::-1]\n    R.append(X[0][0])\n    R.append(X[1][0])\n    if len(X) > 2 and X[2][1] == X[1][1]:\n        print(\"?\")\n        \n    else:\n        print(\" \".join(R))", "n,m=(int(z) for z in input().split())\nPar=[850]*m\nRes=dict()\nr=dict()\nfail=[0]*m\nfor i in range(1,m+1):\n\tr[i]=[]\nfor i in range(n):\n\ts=[z for z in input().split()]\n\tRes[s[0]]=int(s[2])\n\tif len(r[int(s[1])])<2:\n\t\tr[int(s[1])].append(s[0])\n\t\tif Par[int(s[1])-1]>int(s[2]):\n\t\t\tPar[int(s[1])-1]=int(s[2])\n\telif Par[int(s[1])-1]<int(s[2]):\n\t\tif Res[r[int(s[1])][0]]<Res[r[int(s[1])][1]]:\n\t\t\tr[int(s[1])][0]=s[0]\n\t\t\tPar[int(s[1])-1]=min(Res[r[int(s[1])][0]],Res[r[int(s[1])][1]])\n\t\t\tfail[int(s[1])-1]=0\n\t\telif Res[r[int(s[1])][0]]>Res[r[int(s[1])][1]]:\n\t\t\tr[int(s[1])][1]=s[0]\n\t\t\tPar[int(s[1])-1]=min(Res[r[int(s[1])][0]],Res[r[int(s[1])][1]])\n\t\t\tfail[int(s[1])-1]=0\n\t\telse:\n\t\t\tfail[int(s[1])-1]=1\n\t\t\tr[int(s[1])][1]=s[0]\n\telif Par[int(s[1])-1]==int(s[2]):\n\t\tfail[int(s[1])-1]=1\nfor i in range(1,m+1):\n\tif fail[i-1]==0:\n\t\tprint(r[i][0],r[i][1])\n\telse:\n\t\tprint('?')", "n, m = list(map(int, input().split(' ')))\nb = {}\npb = {}\nppb = {}\nfor i in range(n):\n    curline = input().split(' ')\n    name = curline[0]\n    com, ball = list(map(int, curline[1:3]))\n    x = name, ball\n    if com in b:\n        if x[1] > b[com][1]:\n            b[com], x = x, b[com]\n        if com in pb:\n            if x[1] > pb[com][1]:\n                pb[com], x = x, pb[com]\n            if com in ppb:\n                if x[1] > ppb[com][1]:\n                    ppb[com], x = x, ppb[com]\n            else:\n                ppb[com] = x\n        else:\n            pb[com] = x\n    else:\n        b[com] = x\n        \nfor com in range(1, m + 1):\n    if com in ppb and ppb[com][1] == pb[com][1]:\n        print('?')\n    else:\n        print(b[com][0], pb[com][0])\n", "n,m = list(map(int, input().split()))\nl = [[] for i in range(m)]\nfor i in range(n):\n    l1 = input().split()\n    team = int(l1[1])-1\n    l[team].append([int(l1[2]),l1[0]])\n\nfor i in range(m):\n    a = list(sorted(l[i]))[::-1]\n    if len(a) == 2:\n        print(a[0][1],a[1][1])\n    elif a[1][0]==a[2][0]:\n        print(\"?\")\n    else:\n        print(a[0][1],a[1][1])\n", "from sys import stdin as Si\nfrom collections import defaultdict as dt\nfrom operator import itemgetter as ig \ndef __starting_point():\n    n,m = list(map(int,Si.readline().split()))\n    h = dt(dict)\n\n    for i in range(n):\n        s,r,p = list(map(str,Si.readline().split()))\n        r,p = list(map(int,(r,p)))\n        if p in h[r]:   h[r][p]+=[s]\n        else:   h[r][p]=[s]\n    for da in h:\n        d = sorted(list(h[da].items()),key=ig(0),reverse=True)\n        #print(d)\n        ns,i = [],0\n        while len(ns)<2:\n            if len(d[i][1])+len(ns)>=3:\n                ns='?'\n                break\n            else:\n                ns+= d[i][1][:2-len(ns)]\n            i+=1\n            if i>=len(d):   break\n        print(' '.join(ns))\n'''\nVery soon Berland will hold a School Team Programming Olympiad. From each of the m Berland regions a team of two people is invited to participate in the olympiad. The qualifying contest to form teams was held and it was attended by n Berland students. There were at least two schoolboys participating from each of the m regions of Berland. The result of each of the participants of the qualifying competition is an integer score from 0 to 800 inclusive.\n\nThe team of each region is formed from two such members of the qualifying competition of the region, that none of them can be replaced by a schoolboy of the same region, not included in the team and who received a greater number of points. There may be a situation where a team of some region can not be formed uniquely, that is, there is more than one school team that meets the properties described above. In this case, the region needs to undertake an additional contest. The two teams in the region are considered to be different if there is at least one schoolboy who is included in one team and is not included in the other team. It is guaranteed that for each region at least two its representatives participated in the qualifying contest.\n\nYour task is, given the results of the qualifying competition, to identify the team from each region, or to announce that in this region its formation requires additional contests.\nInput\n\nThe first line of the input contains two integers n and m (2\u2009\u2264\u2009n\u2009\u2264\u2009100\u2009000, 1\u2009\u2264\u2009m\u2009\u2264\u200910\u2009000, n\u2009\u2265\u20092m) \u2014 the number of participants of the qualifying contest and the number of regions in Berland.\n\nNext n lines contain the description of the participants of the qualifying contest in the following format: Surname (a string of length from 1 to 10 characters and consisting of large and small English letters), region number (integer from 1 to m) and the number of points scored by the participant (integer from 0 to 800, inclusive).\n\nIt is guaranteed that all surnames of all the participants are distinct and at least two people participated from each of the m regions. The surnames that only differ in letter cases, should be considered distinct.\nOutput\n\nPrint m lines. On the i-th line print the team of the i-th region \u2014 the surnames of the two team members in an arbitrary order, or a single character \"?\" (without the quotes) if you need to spend further qualifying contests in the region.\nExamples\nInput\n\n5 2\nIvanov 1 763\nAndreev 2 800\nPetrov 1 595\nSidorov 1 790\nSemenov 2 503\n\nOutput\n\nSidorov Ivanov\nAndreev Semenov\n\nInput\n\n5 2\nIvanov 1 800\nAndreev 2 763\nPetrov 1 800\nSidorov 1 800\nSemenov 2 503\n\nOutput\n\n?\nAndreev Semenov\n\nNote\n\nIn the first sample region teams are uniquely determined.\n\nIn the second sample the team from region 2 is uniquely determined and the team from region 1 can have three teams: \"Petrov\"-\"Sidorov\", \"Ivanov\"-\"Sidorov\", \"Ivanov\" -\"Petrov\", so it is impossible to determine a team uniquely.\n'''\n            \n        \n\n__starting_point()", "n,m = map(int, input().split())\nl = [[] for i in range(m)]\nfor i in range(n):\n    l1 = input().split()\n    team = int(l1[1])-1\n    l[team].append([int(l1[2]),l1[0]])\n\nfor i in range(m):\n    a = list(sorted(l[i]))[::-1]\n    if len(a) == 2:\n        print(a[0][1],a[1][1])\n    elif a[1][0]==a[2][0]:\n        print(\"?\")\n    else:\n        print(a[0][1],a[1][1])"]