["Mod=1000000007\ns=input()\nn=len(s)\na,b,c,d=1,0,0,0\nfor i in range(0,n):\n    if s[i]=='*':\n        a,b,c,d=0,(a+b+d)%Mod,0,0\n    elif s[i]=='?':\n        a,b,c,d=(a+b+c)%Mod,(a+b+d)%Mod,0,0\n    elif s[i]=='0':\n        a,b,c,d=0,0,(a+c)%Mod,0\n    elif s[i]=='1':\n        a,b,c,d=0,0,b,(a+c)%Mod\n    else:\n        a,b,c,d=0,0,0,(b+d)%Mod\nprint((a+b+c)%Mod)\n", "Mod=1000000007\ns=input()\nn=len(s)\na,b,c,d=1,0,0,0\nfor i in range(0,n):\n    if s[i]=='*':\n        t=0,a+b+d,0,0\n    elif s[i]=='?':\n        t=a+b+c,a+b+d,0,0\n    elif s[i]=='0':\n        t=0,0,a+c,0\n    elif s[i]=='1':\n        t=0,0,b,a+c\n    else:\n        t=0,0,0,b+d\n    a,b,c,d=[a%Mod for a in t]\nprint((a+b+c)%Mod)\n", "m = 1000000007\na, b, c = 1, 0, 1\nfor s in input():\n    if s == '*': a, b, c = 0, b + c, 0\n    elif s == '?': a, b, c = (a + b) % m, (b + c) % m, (a + b) % m\n    elif s == '0': a, b, c = a, 0, 0\n    elif s == '1': a, b, c = b, 0, a\n    else: a, b, c = 0, 0, b\nprint((a + b) % m)", "s=input()\nn=len(s)\na,b,c,d=1,0,0,0\nfor i in range(0,n):\n    if s[i]=='*':\n        a,b,c,d=0,(a+b+d)% 1000000007,0,0\n    elif s[i]=='?':\n        a,b,c,d=(a+b+c)% 1000000007,(a+b+d)% 1000000007,0,0\n    elif s[i]=='0':\n        a,b,c,d=0,0,(a+c)% 1000000007,0\n    elif s[i]=='1':\n        a,b,c,d=0,0,b,(a+c)% 1000000007\n    else:\n        a,b,c,d=0,0,0,(b+d)% 1000000007\nprint((a+b+c)% 1000000007)"]