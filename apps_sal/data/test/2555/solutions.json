["import sys\ninput = lambda: sys.stdin.readline().rstrip()\n\nANS = []\nT = int(input())\nfor _ in range(T):\n    N, Q = list(map(int, input().split()))\n    A = [int(a) for a in input().split()]\n    ans = sum(max(b - a, 0) for a, b in zip([0] + A, A))\n    ANS.append(ans)\n    for _ in range(Q):\n        l, r = list(map(int, input().split()))\n        l, r = l-1, r-1\n        if l == r:\n            ANS.append(ans)\n            continue\n        \n        ans -= max(A[l] - A[l-1], 0) if l else A[l]\n        if l < N - 1: ans -= max(A[l+1] - A[l], 0)\n        if r > l + 1: ans -= max(A[r] - A[r-1], 0)\n        if r < N - 1: ans -= max(A[r+1] - A[r], 0)\n        \n        A[l], A[r] = A[r], A[l]\n        \n        ans += max(A[l] - A[l-1], 0) if l else A[l]\n        if l < N - 1: ans += max(A[l+1] - A[l], 0)\n        if r > l + 1: ans += max(A[r] - A[r-1], 0)\n        if r < N - 1: ans += max(A[r+1] - A[r], 0)\n        \n        ANS.append(ans)\n\nprint(\"\\n\".join(map(str, ANS)))\n\n", "from sys import stdin\n\ntt = int(stdin.readline())\npls = []\n\nfor loop in range(tt):\n\n    n,q = list(map(int,stdin.readline().split()))\n    a   = list(map(int,stdin.readline().split()))\n    a = [0] + a + [0]\n\n    lis = [0] * len(a)\n\n    ans = 0\n    for i in range(1,len(a)-1):\n        if a[i-1] < a[i] and a[i] > a[i+1]:\n            lis[i] = 1\n            ans += a[i]\n        elif a[i-1] > a[i] and a[i] < a[i+1]:\n            lis[i] = -1\n            ans -= a[i]\n\n    pls.append(ans)\n\n    for loop in range(q):\n\n        l,r = list(map(int,stdin.readline().split()))\n        if l == r:\n            pls.append(ans)\n            continue\n        ch = {}\n        ch[l-1] = 0\n        ch[l] = 0\n        ch[l+1] = 0\n        ch[r-1] = 0\n        ch[r] = 0\n        ch[r+1] = 0\n\n        for i in ch:\n            ans -= a[i] * lis[i]\n\n        a[l],a[r] = a[r],a[l]\n\n        for i in ch:\n            if i == 0 or i == len(a)-1:\n                pass\n            elif a[i-1] < a[i] and a[i] > a[i+1]:\n                lis[i] = 1\n                ans += a[i]\n            elif a[i-1] > a[i] and a[i] < a[i+1]:\n                lis[i] = -1\n                ans -= a[i]\n            else:\n                lis[i] = 0\n        pls.append(ans)\n\nprint(\"\\n\".join(map(str,pls)))\n"]