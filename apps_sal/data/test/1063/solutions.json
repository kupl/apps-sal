["def solve(s, t, i, l):\n    if i == l:\n        return False\n    if s[i] == \"?\":\n        if solve(s, t, i + 1, l):\n            s[i] = t[i]\n            return True\n        elif t[i] == \"9\":\n            return False\n        s[i] = nxt[t[i]]\n        for j in range(i, l):\n            if s[j] == \"?\":\n                s[j] = \"0\"\n        return True\n    elif s[i] > t[i]:\n        for j in range(i, l):\n            if s[j] == \"?\":\n                s[j] = \"0\"\n        return True\n    elif s[i] < t[i]:\n        return False\n    else:\n        return solve(s, t, i + 1, l)\n\n\nn = int(input())\na = [list(input()) for _ in range(n)]\np = [\"0\"]\nnxt = {str(x): str(x + 1) for x in range(9)}\n\nfor i, ai in enumerate(a):\n    if len(p) > len(ai):\n        print(\"NO\")\n        break\n    if len(p) < len(ai):\n        if a[i][0] == \"?\":\n            a[i][0] = \"1\"\n        for j in range(len(ai)):\n            if a[i][j] == \"?\":\n                a[i][j] = \"0\"\n    elif not solve(a[i], p, 0, len(ai)):\n        print(\"NO\")\n        break\n    p = a[i]\nelse:\n    print(\"YES\")\n    print(\"\\n\".join(\"\".join(line) for line in a))"]