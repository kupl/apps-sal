["g = {}\ndef push(u, v, w):\n    g[u] = [v, w]\n \nn, pos  = list(map(int, input().split()))\nV = list(map(int, input().split()))\nW = list(map(int, input().split()))\n \nfor _ in range(n):\n    push(_, V[_], W[_])\n \nmax_log = 35\nnext_n  = [[-1] * n for _ in range(max_log)]\nnext_m  = [[float('inf')] * n for _ in range(max_log)]\nnext_s  = [[0] * n for _ in range(max_log)]\n \nfor u in range(n):\n    v, w      = g[u]\n    next_n[0][u]  = v\n    next_m[0][u]  = w\n    next_s[0][u]  = w\n    \nfor k in range(1, max_log):\n    for u in range(n):\n        v  = next_n[k-1][u]\n        m  = next_m[k-1][u]\n        s  = next_s[k-1][u]\n    \n        next_n[k][u] = next_n[k-1][v] \n        next_m[k][u] = min(next_m[k-1][v], m)\n        next_s[k][u] = next_s[k-1][v] + s\n    \nm_arr = [float('inf')] * n\ns_arr = [0] * n\n \nfor _ in range(n):\n    s, m = 0, float('inf')\n    v    = _\n    \n    cur = 1<<max_log\n    i   = max_log\n \n    while cur > 0:\n        if cur & pos:\n            m = min(m, next_m[i][v])\n            s = s + next_s[i][v]\n            v = next_n[i][v]\n            \n        cur >>= 1\n        i    -= 1\n        \n    m_arr[_] = m\n    s_arr[_] = s\n    \narr = [str(x) + ' ' + str(y) for x, y in zip(s_arr, m_arr)]\nprint('\\n'.join([x for x in arr]))\n"]