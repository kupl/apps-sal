["n, m = map(int, input().split())\nm += 1\nq = {'I': 0, 'M': 1, 'A': 2, 'D': 3}\nt = []\nfor i in range(n):\n    t += map(q.get, input())\n    t.append(-7)\nt += [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')", "import sys\nn, m = map(int, input().split())\nm += 1\nd = {'I': 0, 'M': 1, 'A': 2, 'D': 3, '\\n': -7}\nt = list(map(d.get, sys.stdin.read())) + [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')", "import sys\nn, m = list(map(int, input().split()))\nm += 1\nd = {'I': 0, 'M': 1, 'A': 2, 'D': 3, '\\n': -7}\nt = list(map(d.get, sys.stdin.read())) + [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')\n", "import sys\nn, m = list(map(int, input().split()))\nm += 1\nd = {'I': 0, 'M': 1, 'A': 2, 'D': 3, '\\n': -7}\nt = list(map(d.get, sys.stdin.read())) + [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')\n", "import sys\nn, m = list(map(int, input().split()))\nm += 1\nd = {'I': 0, 'M': 1, 'A': 2, 'D': 3, '\\n': -7}\nt = list(map(d.get, sys.stdin.read())) + [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')\n", "import sys\nn, m = list(map(int, input().split()))\nm += 1\nd = {'I': 0, 'M': 1, 'A': 2, 'D': 3, '\\n': -7}\nt = list(map(d.get, sys.stdin.read())) + [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')\n", "import sys\nn, m = list(map(int, input().split()))\nm += 1\nd = {'I': 0, 'M': 1, 'A': 2, 'D': 3, '\\n': -7}\nt = list(map(d.get, sys.stdin.read())) + [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')\n", "import sys\nn, m = list(map(int, input().split()))\nm += 1\nd = {'I': 0, 'M': 1, 'A': 2, 'D': 3, '\\n': -7}\nt = list(map(d.get, sys.stdin.read())) + [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')\n", "import sys\nn, m = list(map(int, input().split()))\nm += 1\nd = {'I': 0, 'M': 1, 'A': 2, 'D': 3, '\\n': -7}\nt = list(map(d.get, sys.stdin.read())) + [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')\n", "import sys\nn, m = list(map(int, input().split()))\nm += 1\nd = {'I': 0, 'M': 1, 'A': 2, 'D': 3, '\\n': -7}\nt = list(map(d.get, sys.stdin.read())) + [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')\n", "import sys\nn, m = map(int, input().split())\nm += 1\nd = {'I': 0, 'M': 1, 'A': 2, 'D': 3, '\\n': -7}\nt = list(map(d.get, sys.stdin.read())) + [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')", "n, m = map(int, input().split())\nm += 1\nq = {'I': 0, 'M': 1, 'A': 2, 'D': 3}\nt = []\nfor i in range(n):\n    t += map(q.get, input())\n    t.append(-7)\nt += [-7] * m\np = [[] for q in t]\nc = [0] * len(t)\nfor a in range(n * m):\n    for b in (a - m, a + m, a - 1, a + 1):\n        if abs(t[b] - t[a] + 1) == 2:\n            p[a].append(b)\n            c[b] += 1\ns = [i for i, q in enumerate(c) if not q]\nwhile s:\n    a = s.pop()\n    for b in p[a]:\n        t[b] = max(t[b], t[a] + 1)\n        c[b] -= 1\n        if c[b] == 0: s.append(b)\nk = max(t) - 2 >> 2\nprint('Poor Inna!' if any(c) else k if k > 0 else 'Poor Dima!')"]