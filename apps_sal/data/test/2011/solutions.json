["import sys\nimport math\ninput = sys.stdin.readline\n\nn,m=map(int,input().split())\narr=[0]*n\nfor i in range(m):\n\tu,v,d=map(int,input().split())\n\tarr[u-1]-=d\n\tarr[v-1]+=d\n\npos=[]\nneg=[]\nfor i in range(n):\n\tif arr[i]>0:\n\t\tpos.append([i,arr[i]])\n\telif arr[i]<0:\n\t\tneg.append([i,-arr[i]])\n\n# print(pos,neg)\nans=[]\nj=0\nfor i in range(len(neg)):\n\twhile neg[i][1]>0:\n\t\t# print(j)\n\t\tif pos[j][1]>=neg[i][1]:\n\t\t\tans.append([neg[i][0]+1,pos[j][0]+1,neg[i][1]])\n\t\t\tpos[j][1]-=neg[i][1]\n\t\t\tneg[i][1]=0\n\t\t\tif pos[j][1]==0:\n\t\t\t\tj+=1\n\t\telse:\n\t\t\tans.append([neg[i][0]+1,pos[j][0]+1,pos[j][1]])\n\t\t\tneg[i][1]-=pos[j][1]\n\t\t\tpos[j][1]=0\n\t\t\tj+=1\n\nprint(len(ans))\nfor i in range(len(ans)):\n\tprint(*ans[i])", "import sys\ninput = sys.stdin.readline\n\nn, m = map(int, input().split())\ninfo = [list(map(int, input().split())) for i in range(m)]\n\nval = [0] * n\nfor i in range(m):\n    a, b, cost = info[i]\n    a -= 1\n    b -= 1\n    val[a] -= cost\n    val[b] += cost\n\nminus = []\nplus = []\nfor i in range(n):\n    if val[i] < 0:\n        minus.append([i, -val[i]]) \n    if val[i] > 0:\n        plus.append([i, val[i]]) \n\nans = []\nnum1 = 0\nfor num2, cost in minus:\n    a = num2 + 1\n    value = cost\n    while True:\n        if value == 0:\n            break\n        if num1 >= len(plus):\n            break\n        if plus[num1][1] <= value:\n            ans.append((a, plus[num1][0] + 1, plus[num1][1]))\n            value -= plus[num1][1]\n            num1 += 1\n        else:\n            ans.append((a, plus[num1][0] + 1, value))\n            plus[num1][1] -= value\n            break\n\nprint(len(ans))\nfor i in ans:\n    print(*i)"]