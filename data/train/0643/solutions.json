["\r\n\r\nd = 10**9 + 7\r\n\r\nt = int(input())\r\nwhile t:\r\n    t-=1\r\n    n =int(input())\r\n    p =list(map(int, input().strip().split()))\r\n    a =list(map(int, input().strip().split()))\r\n    b =list(map(int, input().strip().split()))\r\n    ans = 1\r\n    for i in range(n):\r\n        c = a[i] - b[i] + 1\r\n        tmp = (( pow(p[i],b[i],d) * ((pow(p[i],c,d) - 1 + d)%d) * pow(p[i]-1 , d-2, d)%d))\r\n        ans *= tmp\r\n        ans = ans%d\r\n\r\n    print(ans)"]