["from queue import PriorityQueue\r\nm,n=list(map(int,input().split()))\r\nrr=[]\r\ncc=[]\r\nspeed={'S':3,'O':2,'F':1}\r\nvisited=set()\r\ndp=[]\r\n\r\ndef qwerty(cur,x,y,f):\r\n\tif f==0:\r\n\t\tgg=rr[x][1]+y*rr[x][0]\r\n\t\twhile gg<cur:\r\n\t\t\tgg+=(2*(n-1))*rr[x][0]\r\n\t\treturn gg-cur+rr[x][0]\r\n\telif f==1:\r\n\t\tgg=rr[x][1]+(2*(n-1)-y)*rr[x][0]\r\n\t\twhile gg<cur:\r\n\t\t\tgg+=(2*(n-1))*rr[x][0]\r\n\t\treturn gg-cur+rr[x][0]\r\n\telif f==2:\r\n\t\tgg=cc[y][1]+x*cc[y][0]\r\n\t\twhile gg<cur:\r\n\t\t\tgg+=(2*(m-1))*cc[y][0]\r\n\t\treturn gg-cur+cc[y][0]\t\t\r\n\telif f==3:\r\n\t\tgg=cc[y][1]+(2*(m-1)-x)*cc[y][0]\r\n\t\twhile gg<cur:\r\n\t\t\tgg+=(2*(m-1))*cc[y][0]\r\n\t\treturn gg-cur+cc[y][0]\r\n\r\n\r\ndirx=[0, 0, 1, -1]\r\ndiry=[1, -1, 0, 0]\r\n\r\nfor i in range(m):\r\n\to=[x for x in input().split()]\r\n\to[0]=speed[o[0]]\r\n\to[1]=int(o[1])\r\n\trr.append(o)\r\n\r\n\r\nfor i in range(n):\r\n\to=[x for x in input().split()]\r\n\to[0]=speed[o[0]]\r\n\to[1]=int(o[1])\r\n\tcc.append(o)\r\n\r\n\r\nsx,sy,stt,dx,dy=list(map(int,input().split()))\r\nsx-=1\r\nsy-=1\r\ndx-=1\r\ndy-=1\r\n\r\nfor i in range(m):\r\n\tdp.append([10**9]*n)\r\n\r\ndp[sx][sy]=stt\r\npq = PriorityQueue()\r\npq.put((stt, sx, sy))\r\nwhile not pq.empty():\r\n\t#print(dp)\r\n\t(t,cxx,cyy)=pq.get()\r\n\tif (cxx,cyy) in visited:\r\n\t\tcontinue\r\n\tvisited.add((cxx,cyy))\r\n\tfor i in range(len(dirx)):\r\n\t\tnxx=cxx+dirx[i]\r\n\t\tnyy=cyy+diry[i]\r\n\t\tif nxx>=0 and nxx<m and nyy>=0 and nyy<n and (nxx,nyy) not in visited:\r\n\t\t\tcoo=qwerty(dp[cxx][cyy],cxx,cyy,i)\r\n\t\t\tif coo+dp[cxx][cyy]<dp[nxx][nyy]:\r\n\t\t\t\t\tdp[nxx][nyy]=coo+dp[cxx][cyy]\r\n\t\t\t\t\tpq.put((dp[nxx][nyy],nxx,nyy))\r\n\r\nprint(dp[dx][dy])\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\r\n\r\n\r\n\r\n"]