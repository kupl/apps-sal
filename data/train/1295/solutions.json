["mod=10**9+7\ndef fibonacci(n):\n if n < 0:\n  raise ValueError(\"Negative arguments not implemented\")\n return (_fib(n)[0]%mod + mod)%mod;\ndef _fib(n):\n if n == 0:\n  return (0, 1)\n else:\n  a, b = _fib(n // 2)\n  c = (a * (b * 2 - a))%mod\n  d = (a * a + b * b)%mod\n  if n % 2 == 0:\n   return (c, d)\n  else:\n   return (d, c + d)\ndef inv(n):\n return pow(n,mod-2,mod)\ndef brute(n,k):\n ret = 0\n for i in range(0,n+1):\n  ret+=fibonacci(i)*pow(k,i,mod)\n return ret%mod\ndef ans(n,k):\n k%=mod\n a = pow(k,n+1,mod)\n b=(a*k)%mod\n x = a*(fibonacci(n+1))+b*fibonacci(n)-k\n y = inv((k*k+k-1)%mod)\n return ((x*y)%mod+mod)%mod\nfor t in range(0,eval(input())):\n n,k = list(map(int,input().split()))\n print(ans(n,k))"]