["t=int(input())\r\nfor _ in range(t):\r\n    n=int(input())\r\n    arr=list(map(int,input().split()))\r\n    d={}\r\n    for i in range(n):\r\n        if arr[i] in d:\r\n            d[arr[i]].append(i)\r\n        else:\r\n            d[arr[i]]=[i]\r\n    q=int(input())\r\n    for i in range(q):\r\n        m=int(input())\r\n        if len(d[m])==1:\r\n            print(n)\r\n        elif len(d[m])==2:\r\n            print(min((d[m][1]-d[m][0]),((n-d[m][1])+d[m][0])))\r\n        else:\r\n            k=100000\r\n            for j in range(len(d[m])-1):\r\n                if (d[m][j+1]-d[m][j])<k:\r\n                    k=d[m][j+1]-d[m][j]\r\n                else:\r\n                    pass\r\n            print(min(k,((n-d[m][len(d[m])-1])+d[m][0])))\r\n            \r\n                \r\n"]