["'''input\n2\n7 3 5\n5 2 5 2\n2 4 2 6\n6 2 6 4\n5 6 5 7\n7 1 7 4\n7 3 7\n1 1 6 1\n1 2 3 2\n5 2 5 2\n2 6 2 6\n6 2 6 4\n5 6 5 7\n7 1 7 4\n'''\n\nfor _ in range(int(input())):\n n, k, m = list(map(int, input().split()))\n row_s = []\n col_s = []\n for _ in range(m):\n  h_x, h_y, t_x, t_y = list(map(int, input().split()))\n  if h_x == t_x:\n   if (h_x < (((n - k) // 2) + 1)) or (h_x > (((n - k) // 2) + k)):\n    col_s.append([min(h_y, t_y), max(h_y, t_y)])\n   else:\n    row_s.append([h_x, h_x])\n  if h_y == t_y:\n   if (h_y < (((n - k) // 2) + 1)) or (h_y > (((n - k) // 2) + k)):\n    row_s.append([min(h_x, t_x), max(h_x, t_x)])\n   else:\n    col_s.append([h_y, h_y])\n row_s.sort()\n col_s.sort()\n\n poss = True\n\n if len(col_s) == 0 or len(row_s) == 0:\n  print(-1)\n  continue\n\n # print(row_s, col_s)\n\n next_row = ((n - k) // 2) + 1\n i = 0\n count_row = 0\n while i < len(row_s):\n  max_next = next_row\n  if next_row < row_s[i][0]:\n   poss = False\n   break\n  while i < len(row_s) and row_s[i][0] <= next_row:\n   # print(max_next, row_s[i], next_row)\n   max_next = max(max_next, row_s[i][1] + 1)\n   # print(max_next, row_s[i], next_row)\n   i += 1\n  next_row = max_next\n  count_row += 1\n  if next_row > (((n - k) // 2) + k):\n   break\n  if next_row < (((n - k) // 2) + k) and i >= len(row_s) :\n   poss = False\n   break\n\n # print(count_row)\n\n next_col = ((n - k) // 2) + 1\n i = 0\n count_col = 0\n while i < len(col_s):\n  max_next = next_col\n  if next_col < col_s[i][0]:\n   poss = False\n   break\n  while i < len(col_s) and col_s[i][0] <= next_col:\n   # print(max_next, col_s[i], next_col)\n   max_next = max(max_next, col_s[i][1] + 1)\n   # print(max_next, col_s[i], next_col)\n   i += 1\n  next_col = max_next\n  count_col += 1\n  if next_col > (((n - k) // 2) + k):\n   break\n  if next_col < (((n - k) // 2) + k) and i >= len(col_s) :\n   poss = False\n   break\n\n # print(count_col)\n print(count_col + count_row if poss else -1)\n\n # print(row_s, col_s)\n"]