["a=int(input())\r\nfor _ in range(a):\r\n    c,d=list(map(int,input().split()))\r\n    crr=[[[0,0] for i in range(c+1)] for j in range(c+1)]\r\n    trr=[]\r\n    for i in range(c):\r\n        kk=list(input().split())\r\n        trr.append(kk)\r\n    for i in range(1,c+1):\r\n        for j in range(1,c+1):\r\n            if(trr[i-1][j-1]=='a'):\r\n                crr[i][j][0]=max(crr[i-1][j][0],crr[i][j-1][0])+1\r\n                if(j==1):\r\n                    crr[i][j][1]=crr[i-1][j][1]+1\r\n                elif(i==1):\r\n                    crr[i][j][1]=crr[i][j-1][1]+1\r\n                elif(crr[i-1][j][0]>crr[i][j-1][0]):\r\n                    crr[i][j][1]=crr[i-1][j][1]+1\r\n                else:\r\n                    crr[i][j][1]=crr[i][j-1][1]+1\r\n            else:\r\n                crr[i][j][0]=max(crr[i-1][j][0],crr[i][j-1][0])\r\n                if(j==1):\r\n                    crr[i][j][1]=crr[i-1][j][1]+1\r\n                elif(i==1):\r\n                    crr[i][j][1]=crr[i][j-1][1]+1\r\n                elif(crr[i-1][j][0]>crr[i][j-1][0]):\r\n                    crr[i][j][1]=crr[i-1][j][1]+1\r\n                else:\r\n                    crr[i][j][1]=crr[i][j-1][1]+1\r\n        \r\n    for i in range(d):\r\n        m,n=list(map(int,input().split()))\r\n        print(crr[m][n][1]-crr[m][n][0])\r\n    \r\n", "t=int(input())\r\nfor _ in range(t):\r\n    n,q=list(map(int,input().split()))\r\n    main=[[0]*(n+1)]\r\n    final=[[0]*(n+1)]\r\n    const=[[0]*(n+1)]\r\n    for i in range(n):\r\n        l=[0]*(n+1)\r\n        z=[0]*(n+1)\r\n        w=list(input().split())\r\n        w.insert(0,0)\r\n        final.append(w)\r\n        main.append(l)\r\n        const.append(z)\r\n\r\n    for i in range(1,n+1):\r\n        for j in range(1,n+1):\r\n            \r\n            main[i][j]=max(main[i-1][j],main[i][j-1])\r\n            if final[i][j]=='a':\r\n                main[i][j]+=1\r\n            if main[i-1][j]>main[i][j-1]:\r\n                const[i][j]+=const[i-1][j]\r\n            else:\r\n                const[i][j]+=const[i][j-1]\r\n            if final[i][j]!='a':\r\n                const[i][j]+=1\r\n                \r\n                \r\n            \r\n    for i in range(q):\r\n        s,d=list(map(int,input().split()))\r\n        print(s+d-1-main[s][d])\r\n    \r\n    \r\n", "t=int(input())\r\nfor sai in range(t):\r\n    n,m=[int(x) for x in input().split()]\r\n    a=[]\r\n    for i in range(n):\r\n        a.append(input().split())\r\n    for i in range(n):\r\n        for j in range(n):\r\n            if(a[i][j]=='a'):\r\n                a[i][j]=[1,-1]\r\n            else:\r\n                a[i][j]=[0,-1]\r\n    a[0][0][1]=1\r\n    for i in range(1,n):\r\n        a[0][i][0]=a[0][i-1][0]+a[0][i][0]\r\n        a[0][i][1]=a[0][i-1][1]+1\r\n    for i in range(1,n):\r\n        a[i][0][0]=a[i-1][0][0]+a[i][0][0]\r\n        a[i][0][1]=a[i-1][0][1]+1\r\n\r\n    for i in range(1,n):\r\n        for j in range(1,n):\r\n            if(a[i-1][j][0]>a[i][j-1][0]):\r\n                a[i][j][0]=a[i-1][j][0]+a[i][j][0]\r\n                a[i][j][1]=a[i-1][j][1]+1\r\n            else:\r\n                a[i][j][0]=a[i][j-1][0]+a[i][j][0]\r\n                a[i][j][1]=a[i][j-1][1]+1\r\n    for i in range(m):\r\n        p,q=[int(x) for x in input().split()]\r\n        print(a[p-1][q-1][1]-a[p-1][q-1][0])\r\n        \r\n                \r\n        \r\n        \r\n    \r\n"]