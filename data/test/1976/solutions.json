["import sys\nfrom operator import itemgetter\n\nn, m, k, q = list(map(int, input().split()))\nquery = sorted((list(map(int, line.split()))\n                for line in sys.stdin), key=itemgetter(2))\ntimes = [q[2] for q in query]\n\n\ndef solve(ti):\n    imos = [[0]*(m+1) for _ in range(n+1)]\n    for i in range(ti):\n        imos[query[i][0]][query[i][1]] += 1\n\n    for i in range(n+1):\n        for j in range(m):\n            imos[i][j+1] += imos[i][j]\n    for j in range(m+1):\n        for i in range(n):\n            imos[i+1][j] += imos[i][j]\n    for i in range(k, n+1):\n        for j in range(k, m+1):\n            if imos[i][j] - imos[i-k][j] - imos[i][j-k] + imos[i-k][j-k] == k*k:\n                return True\n    return False\n\n\ninf = len(times)+1\nok, ng = inf, 0\nwhile abs(ok - ng) > 1:\n    mid = (ok + ng) >> 1\n    if mid >= k*k and solve(mid):\n        ok = mid\n    else:\n        ng = mid\n\nprint(times[ok-1] if ok != inf else -1)\n"]