["t = int(input())\n\ndef get_max(n):\n    ans = 0\n    while n:\n        ans = 4 * ans + 1\n        n = n - 1\n        if ans > 10**19:\n            break\n    return ans\n\nfor _ in range(t):\n    n, k = list(map(int, input().split()))\n    if n == 1:\n        if k == 1:\n            print(\"YES 0\")\n        else:\n            print(\"NO\")\n    elif n == 2:\n        if k <= 2:\n            print(\"YES 1\")\n        elif k != 3 and k <= 5:\n            print(\"YES 0\")\n        else:\n            print(\"NO\")\n    else:\n        siz = n - 1\n        l = 1\n        cnt = 3\n        while siz:\n            if l <= k < l+cnt:\n                print(\"YES {}\".format(siz))\n                break\n            l = l + cnt\n            cnt = 2 * cnt + 1\n            siz = siz - 1\n        else:\n            if k <= get_max(n):\n                print(\"YES 0\")\n            else:\n                print(\"NO\")\n", "def ii():\n    return int(input())\ndef mi():\n    return list(map(int, input().split()))\ndef li():\n    return list(mi())\n\nfor t in range(ii()):\n    n, k = mi()\n    if n == 1:\n        ans = 'YES 0' if k == 1 else 'NO'\n    elif n == 2:\n        if k <= 2:\n            ans = 'YES 1'\n        elif k == 3 or k > 5:\n            ans = 'NO'\n        else:\n            ans = 'YES 0'\n    elif n <= 32 and k > (4 ** n - 1) // 3:\n        ans = 'NO'\n    else:\n        c, x = 0, n\n        p2 = 2\n        while x > 0:\n            if c + p2 - 1 > k:\n                break\n            c += p2 - 1\n            x -= 1\n            p2 *= 2\n        ans = 'YES %d' % (x,)\n    print(ans)\n", "'''input\n3\n1 1\n2 2\n2 12\n'''\nfor _ in range(int(input())):\n\tdef get(n):\n\t\treturn (4**n-1)//3\n\tn,k = map(int,input().split())\n\tif n<32 and 4**n < 1*3*k:\n\t\tprint(\"NO\")\n\t\tcontinue\n\tnow = 1\n\tp = 2\n\tans = n\n\tsq = 0\n\tbuff = 0\n\td = 4\n\twhile k>=now:\n\t\tk -= now\n\t\tp *= 2\n\t\tnow = p-1\n\t\tans -= 1\n\n\t\tsq = sq*4 + d-3\n\t\td *= 2\n\t\tif n < 60:\n\t\t\tbuff += sq * (4**ans-1)//3\n\t\telse:\n\t\t\tbuff = 10**19\n\t\t# print(sq, k, buff)\n\t\tif ans == 0: break\n\t\t# if n < 60:\n\t\t# \tbuff += get(ans)\n\tif buff < k: print(\"NO\")\n\telse: print(\"YES\",max(ans,0))", "T = int(input())\n\nwhile (T != 0):\n    T -= 1\n\n    N, K = list(map(int, input().split()))\n    cur_usage = 0\n    reslog = 0\n    cnts = dict()\n\n    while True:\n        reslog += 1\n        cur_usage +=  (1 << reslog) - 1\n        if reslog != N:\n            cnts[reslog] = (((1 << reslog)-2)<<1) + 1\n\n        if cur_usage + (1 << (reslog+1))-1 > K or reslog == N:\n            break\n\n    K -= cur_usage\n\n    while K > 0:\n        if len(cnts) == 0:\n            break\n        for key in cnts:\n            K -= cnts[key]\n            if key+1 >= N:\n                del cnts[key]\n                break\n            if (key+1 not in cnts):\n                cnts[key+1] = 0\n            cnts[key+1] += cnts[key] * 4\n            del cnts[key]\n            break\n\n\n\n\n    if K <= 0:\n        print('YES %d' % (N-reslog))\n    else:\n        print('NO')\n        \n\n\n\n\n", "case = int(input())\nfor i in range(case):\n\tf = [0] * 32\n\tg = [0] * 32\n\tsuccess = False\n\tn,k = map(int,input().split())\n\tans = n\n\tfor i in range(1,n):\n\t\tf[i] = f[i - 1] * 4 + 1\n\t\tif f[i] >= k:\n\t\t\tsuccess = True\n\t\t\tbreak\n\tfor i in range(1,n + 1):\n\t\tif k < (1 << i) - 1:\n\t\t\tbreak\n\t\tk = k - (1 << i) + 1\n\t\tans = ans - 1\n\tfor i in range(n - 1,ans - 1,-1):\n\t\tif i >= 32 or (i and f[i] == 0):\n\t\t\tsuccess = True\n\t\t\tbreak\n\t\tg[i] = 1 if i == n - 1 else g[i + 1] * 2 + 3\n\t\tk = k - f[i] * g[i]\n\t\tif k <= 0:\n\t\t\tsuccess = True\n\t\t\tbreak\n\tprint(\"YES %d\"%ans if success else \"NO\");", "import sys\nimport math\ninput = sys.stdin.readline\n\ntestcase=int(input())\nT=[list(map(int,input().split())) for i in range(testcase)]\n\ndef bi(n,k):\n    MIN=0\n    MAX=n\n\n    while MAX>MIN+1:\n        bn=(MIN+MAX)//2\n        if math.log2(k+2+bn)<bn+1:\n            MAX=bn\n        elif math.log2(k+2+bn)==bn+1:\n            return bn\n        else:\n            MIN=bn\n\n    if MAX+1<=math.log2(k+2+MAX):\n        return MAX\n\n    return MIN\n\nfor n,k in T:\n    if n==1:\n        if k==1:\n            print(\"YES\",0)\n        else:\n            print(\"NO\")\n        continue\n\n    if n==2:\n        if 1<=k<=2:\n            print(\"YES\",1)\n        elif k==3:\n            print(\"NO\")\n        elif 4<=k<=5:\n            print(\"YES\",0)\n        else:\n            print(\"NO\")\n        continue\n        \n    if n<=30 and k>(pow(4,n)-1)//3:\n        print(\"NO\")\n        continue\n\n    ANS=bi(n,k)\n\n    print(\"YES\",n-ANS)\n    \n    \n"]