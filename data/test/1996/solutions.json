["n=int(input())\nc=set('qwertyuiopasdfghjklzxcvbnm')\nch=False\nk=0\nfor i in range(n-1):\n    s=input()\n    if ch:\n        if s[0]!='.':\n            k+=1\n    else:\n        if s[0]=='.':\n            c.difference_update(set(s[2:]))\n        elif s[0]=='!':\n            c.intersection_update(set(s[2:]))\n        else:\n            if s[2] in c:\n                c.remove(s[2])\n        if len(c)==1:\n            ch=True\ninput()\nprint(k)", "n = int(input())\n\na = [chr(i) for i in range(97, 123)]\na = set(a)\ncnt = 0\nf = False\nfor i in range(n):\n    r, w = input().split()\n    w = set(list(w))\n    if len(a) == 1:\n        f = True\n    if r == \".\":\n        a = a - w\n    elif r == \"!\":\n        a = a & w\n        cnt += int(f)\n    elif r == \"?\" and (i+1) != n:\n        a = a - w\n        cnt += int(f)\n    #print(a)\nprint(cnt)\n", "s = \"qwertyuiopasdfghjklzxcvbnm\"\na = set()\nfor i in s:\n    a.add(i)\n#print(a)\nn = int(input())\nans = 0\nfor i in range(n):\n    s = input().split()\n    # print(s)\n\n    if(s[0] == \"!\" and len(a) == 1):\n        ans+=1\n    elif len(a) == 1 and s[0] == \"?\" and i != n-1:\n        ans+=1\n    elif s[0] == \"?\":\n        try:\n            a.remove(s[1])\n        except Exception:\n            pass\n    elif s[0] == \".\":\n        for j in s[1]:\n           # print(a)\n            try:\n                a.remove(j)\n            except Exception:\n                pass\n    elif s[0] == \"!\":\n        b = dict()\n        for j in s[1]:\n            b[j] = 1\n        for j in a:\n            try:\n                b[j]+=1\n            except Exception:\n                pass\n        a.clear()\n        for j in b:\n            if b[j] == 2:\n                a.add(j)\n    #print(a)\nprint(ans)", "s = set()\ni = 'a'\nwhile i <= 'z':\n  s.add(i)\n  i = chr(ord(i)+1)\nn = int(input())\nc=0\nfor i in range(n):\n  a = input().split()\n  if a[0] == '.':\n    s.difference_update(set(a[1]))\n  elif len(s) == 1 and i != n-1:\n    c+=1\n  if a[0] == '!':\n    s.intersection_update(set(a[1]))\n  if a[0] == '?':\n    if a[1] in s:\n      s.remove(a[1])\nprint(c)\n", "#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\nfrom string import ascii_lowercase\n\n\ndef main():\n\tn = int(input())\n\tcan = set(ascii_lowercase)\n\ti = -1\n\tfound = False\n\tcnt = 0\n\tfor j in range(n):\n\t\tturn, word = input().split()\n\t\tif found and j != n - 1 and turn != '.':\n\t\t\tcnt += 1\n\t\tif turn == '.':\n\t\t\tcan -= set(word)\n\t\t\tif len(can) == 1 and not found:\n\t\t\t\ti = j\n\t\t\t\tfound = True\n\t\telif turn == '!':\n\t\t\tcan &= set(word) \n\t\t\tif len(can) == 1 and not found:\n\t\t\t\ti = j\n\t\t\t\tfound = True\t\t\t\t\n\t\telse:\n\t\t\tif j == n-1:\n\t\t\t\ti = n-1\n\t\t\t\tbreak\n\t\t\telse:\n\t\t\t\tcan -= set(word)\n\t\t\t\tif len(can) == 1 and not found:\n\t\t\t\t\ti = j\n\t\t\t\t\tfound = True\n\tprint(cnt)\n\n\n\ndef __starting_point():\n\tmain()\n\n__starting_point()", "n = int(input())\nnemog = set()\nmog = set()\nfor i in range(26):\n    mog.add(chr(97 + i))\n    \ncnt = 0\nflag = False\n\nfor i in range(n):\n    s = input()\n    if s[0] == '.':\n        for j in range(2, len(s)):\n            mog.discard(s[j])\n    if s[0] == '!':\n        cnt += 1\n        help = set()\n        for j in range(2, len(s)):\n            help.add(s[j])\n        mog = mog & help\n    if s[0] == '?':\n        if i < n - 1:\n            cnt += 1\n            mog.discard(s[2])\n        else:\n            print(0)\n            flag = True\n    if len(mog) == 1:\n        save = i\n        break\nif not flag:\n    ans = 0\n    for i in range (save + 1, n):\n        s = input()\n        if s[0] == '!' or (i < n - 1 and s[0] == '?'):\n            ans += 1\n    print(ans)", "n = int(input())\ny = set()\nopr = False\ncount = 0\nfor i in range(97, 123):\n\ty.add(chr(i))\nfor i in range(n):\n\ts = input()\n\ts = s.split(\" \")\n\ta = s[1]\n\tif not opr:\n\t\tz = set()\n\t\tfor j in a:\n\t\t\tz.add(j)\n\t\tif s[0] == \"!\":\n\t\t\ty = y.intersection(z)\n\t\telif s[0] == \".\":\n\t\t\ty = y.difference(z)\n\t\telif s[0] == \"?\" and i != n - 1:\n\t\t\tq = set()\n\t\t\tq.add(s[1])\n\t\t\ty = y.difference(q)\n\t\tif len(y) == 1:\n\t\t\topr = True\n\telse:\n\t\tif (s[0] == \"?\" and i != n - 1) or s[0] == \"!\":\n\t\t\tcount += 1\nprint(count)\t\t\t\n\n\t\t\t\n\t\t\n\t\t\n", "n = int(input())\nmn = set('qwertyuiopasdfghjklzxcvbnm')\nf = False\nk = 0\nfor i in range(n):\n        \n    s = input().split()\n    if f:\n        if s[0] == '?' and set(s[1]) != mn or s[0] =='!':\n            k += 1\n        continue\n    if s[0] == '?'and i != n-1:\n        mn -= set(s[1])\n    elif s[0] == '!':\n        mn &= set(s[1])\n    elif s[0] == '.':\n        mn -= set(s[1])\n    if len(mn) == 1:\n        f = True\nprint(k)\n", "n = int(input())\ns = set(\"abcdefghijklmnopqrstuvwxyz\")\nmark = False\ncnt = 0\nfor i in range(n):\n    if len(s) == 1:\n        mark = True\n    tmp = input().split()\n    if tmp[0] == \"!\":\n        if mark:\n            cnt += 1\n        curs = set(tmp[1])\n        s = s & curs\n    if tmp[0] == \".\":\n        curs = set(tmp[1])\n        s -= curs\n    if tmp[0] == \"?\":\n        if mark:\n            cnt += 1\n            if i == n - 1:\n                cnt -= 1\n        s -= set(tmp[1])\nprint(cnt)\n", "n = int(input())\n\ns = set()\nfor i in range(ord('a'), ord('z') + 1):\n    s.add(chr(i))\n\nk = 0\nfl = False\nfor i in range(n - 1):\n    q = input().split()\n    if fl:\n        if q[0] == '!' or q[0] == '?':\n            k += 1\n    if q[0] == '.':\n        for ch in q[1]:\n            s.discard(ch)\n    elif q[0] == '!':\n        s = s.intersection(set(q[1]))\n    elif q[0] == '?':\n        s.discard(q[1])\n    if len(s) == 1:\n        fl = True\nq = input()\n\nprint(k)\n", "q=int(input())\nd=set([chr(i) for i in range(97,123)])\ngf=0\nfor i in range(0,q-1):\n    s=input()\n    s1=s[2:]\n    if s[0]=='!':\n        if len(d)==1:\n            gf+=1\n        d&=set(s1)\n    elif s[0]=='.':\n        d=d.difference(set(s1))\n    else:\n        if len(d)==1:\n            gf+=1\n        d=d.difference(set(s1))\n    \n    #print(d)\ns=input()\nprint(gf)\n", "n=int(input())\nalf='abcdefghijklmnopqrstuvwxyz'\nso='';\nj=n\nfor i in range(n):\n    s=input()\n    j-=1\n    if s[0]=='!':\n        so = '';\n        for e in alf:\n            if s.find(e)>-1: so+=e;\n        alf=so\n    elif s[0]=='.':\n        so = '';\n        for e in alf:\n            if s.find(e)==-1: so+=e;\n        alf=so\n    else:\n        alf=alf.replace(s[2],'')\n    if len(alf)==1: break\nlol=0;\np=j;\nfor i in range(j-1):\n    s = input()\n    if s[0]=='!' or s[0]=='?': lol+=1\nif not(p==0):s = input()\nprint(lol)", "n = int(input())\nl1 = {'a', 'b', 'c', 'd', 'e', 'f', 'g', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'h', 'w', 'y', 'x', 'z', 'v'}\nfor i in range(n - 1):\n    l = list(input())\n    if l[0] == '.':\n        l = set(l[2:])\n        l1 -= l\n    elif l[0] == '!':\n        l = set(l[2:])\n        l1 &= l\n    else:\n        l1 -= set(l[2])\n    if len(l1) == 1:\n        q = 0\n        for k in range(n - i - 2):\n            l = list(input())\n            if l[0] != '.':\n                q += 1\n        print(q)\n        break\nif len(l1) > 1:\n    print(0)\n", "n=int(input())\nmn=set()\notv=set()\nk=0\nfor i in range(ord('a'),ord('z')+1):\n    otv.add(chr(i))\nfor i in range(n):\n    s=input().split()\n    if s[0]=='!':\n        otv=set(s[1])&otv\n    elif s[0]=='.':\n        otv-=set(s[1])\n    else:\n        if i!=n-1:\n            otv-=set(s[1])\n    if len(otv)==1:\n        break\nfor bb in range(i+1, n):\n    s=input().split()\n    if s[0]!='.':\n        k+=1\nk-=1\nif k<0:\n    k=0\nprint(k)\n    \n", "n = int(input())\na = 0\nb = 0\nflag = True\nt = set(list('qwertyuioplkjhgfdsazxcvbnm'))\nfor i in range(n):\n    op, w = list(map(str, input().split()))\n    w = set(list(w))\n    if op == '!':\n        t &= w\n        a += 1\n        if flag:\n            b += 1\n    elif op == '.':\n        t = t.difference(w)\n    else:\n        t = t.difference(w)\n        if i != n - 1:\n            a += 1\n            if flag:\n                b += 1\n    if len(t) == 1:\n        flag = False\nprint(a - b)\n", "a=set('abcdefghijklmnopqrstuvwxyz')\nn=int(input())\nfor i in range (n):\n    e,b=input().split()\n    if e=='!':\n        a.intersection_update(set(b))\n    elif e=='?' and (i!=(n-1)):\n        a.difference_update(set(b))\n    elif e=='.':\n        a.difference_update(set(b))\n    if len (a)==1:\n        break\ns=0\nfor j in range (i+1,n):\n    e,b=input().split()\n    if e=='!' or (e=='?' and j!=(n-1)):\n        s+=1\nprint(s)\n", "c=int(input())\nans=0\nq=0\nm=[[i,1]for i in 'abcdefghijklmnopqrstuvwxyz']\nfor i in range(c):\n    suma=0\n    for j in range(26):\n        suma+=m[j][1]\n    if suma<2:\n        q=1\n    x=input()\n    a=set(x[2:])\n    x=x[0]\n    if x=='.':\n        for j in range(26):\n            if m[j][0]in a:\n                m[j][1]=0\n    elif x=='!':\n        for j in range(26):\n            if not(m[j][0]in a):\n                m[j][1]=0\n        if q:\n            ans+=1\n    else:\n        for j in range(26):\n            if m[j][0]in a:\n                m[j][1]=0\n        if i!=c-1 and q:\n            ans+=1\nprint(ans)\n", "n = int(input())\nno = set()\nmb = set(\"abcdefghijklmnopqrstuvwxyz\")\nans = 0\nmark = False\nfor i in range(n):\n    flag, save = input().split()\n    if(flag == \"!\"):\n        for_add = set()\n        for j in range(len(save)):\n            for_add.add(save[j])\n        if(len(mb) == 0):\n            mb = for_add\n        else:\n            mb = for_add & mb\n        if(mark):\n            ans += 1\n    elif(flag == \".\"):\n        for j in range(len(save)):\n            no.add(save[j])\n    else:\n        if(i != n - 1):\n            no.add(save)\n            if(mark):\n                ans += 1\n    if(len(mb - no) == 1 or len(mb) == 1):\n        mark = True\n        \nprint(ans)", "n = int(input())\nlet = set()\nfor i in range(97, 123):\n    let.add(chr(i))\nflag = 0\nans = 0\nfor i in range(n - 1):\n    if len(let) == 1:\n        flag = 1\n    t, s = map(str, input().split())\n    #print(t, s)\n    if t == '!':\n        now = set(list(s))\n        if flag == 1:\n            ans += 1\n        let = let.intersection(now)\n        #print(now)\n        #print(let)\n    if t == '?':\n        if flag == 1:\n            ans += 1\n        if s in let:\n            let.remove(s)\n    if t == '.':\n        now = list(s)\n        for elem in now:\n            if elem in let:\n                let.remove(elem)\nprint(ans)", "n = int(input())\nsetr = set(chr(i) for i in range(ord('a'), ord('z') + 1))\nsetnr = set()\nans = 0\nletter =''\nisq = False\na = [input() for i in range(n)]\nfor s in a:\n    if s[0] == '.':\n        setnr = setnr | set(s[2:])\n    elif s[0] == '!':\n        if len(setr - setnr) == 1 or isq:\n            ans += 1\n        if len(setr) == 0:\n            setr = set(s[2:])\n        else:\n            setr = setr & set(s[2:])\n    elif s[0] == '?' and s[2] != a[-1][2]:\n        if len(setr - setnr) == 1 or isq:\n            ans += 1\n        else:\n            setnr.add(s[2])\n    elif s[0] == '?' and s[2] == a[-1][2]:\n        isq = True\nprint(ans)\n", "n = int(input())\nl=[chr(i) for i in range(97,123)]\nk=0\nfor i in range(n):\n    d,s=list(map(str, input().split()))\n    if d=='!' and len(l)!=1:\n        h=0\n        while h<len(l):\n            if not(l[h] in s):\n                l.pop(h)\n            else:\n                h+=1\n    elif d=='.' and len(l)!=1:\n        h=0\n        while h<len(l):\n            if l[h] in s:\n                l.pop(h)\n            else:\n                h+=1\n    elif d=='?' and len(l)!=1:\n        if s in l:\n            l.remove(s)\n    elif (d=='?' or d=='!') and i!=n-1:\n        k+=1\nprint(k)\n", "n = int(input())\nset1 = set()\nans = 0\nfor i in range(97,123):\n    set1.add(chr(i))\nfor i in range(n):\n    a, b = input().split()\n    if len(set1) == 1:\n        if a == \"?\" and i != n - 1:\n            ans += 1\n        if a == \"!\":\n            ans += 1\n    else:\n        set2 = set()\n        for i in b:\n            set2.add(i)\n            \n        if a == \".\":\n            set1 -= set2\n        elif a == \"!\":\n            set1 &= set2\n        elif a == \"?\":\n            set1 -= set2\nprint(ans)", "n = int(input())\nSetA = set(\"abcdefghijklmnopqrstuvwxyz\")\nflag = False\nlol = 0\nb = 0\nfor i in range(n):\n    b += 1564\n    if len(SetA) == 1:\n        flag = True\n    pit = input().split()\n    if pit[0] == \"!\":\n        if flag:\n            lol += 1\n        curs = set(pit[1])\n        SetA = SetA & curs\n    if pit[0] == \".\":\n        curs = set(pit[1])\n        SetA -= curs\n    if pit[0] == \"?\":\n        if flag:\n            lol += 1\n            if i == n - 1:\n                lol -= 1\n        SetA -= set(pit[1])\n    b -= 1564\nprint(lol)", "n = int(input())\na = set(list('qwertyuiopasdfghjklzxcvbnm'))\nal = 0\nq = 0\nz = 0\nfor i in range(n):\n    k = input().split()\n    if k[0] == '.':\n        a -= set(list(k[1]))\n    elif k[0] == '?':\n        a -= set(list(k[1]))\n        al += 1\n        z += 1\n    else:\n        a &= set(list(k[1]))\n        al += 1\n        z += 1\n    #print(al, a)\n    if len(a) == 1:\n        q = i + 1\n        break\n\nif len(a) != 1:\n    print(0)   \n\n\nelse:\n    for i in range(q, n):\n        k = input().split()\n        if k[0] != '.':\n            al += 1 \n    #print(al, z)\n    print(al - z - 1)\n", "n = int(input())\nposs = {'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'}\nstrikes = 0\nfound = False\nfor i in range(n - 1):\n    a = input().split()\n    if a[0] == '!':\n        poss = poss.intersection(set(a[1]))\n        if found:\n            strikes += 1\n    elif a[0] == '.':\n        poss = poss.difference(set(a[1]))\n    else:\n        poss = poss.difference(set(a[1]))\n        if found:\n            strikes += 1\n    if len(poss) == 1:\n        found = True\nprint(strikes)\n"]