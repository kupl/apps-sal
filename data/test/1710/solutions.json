["#!/usr/bin/env python3\n\n[n, k] = list(map(int, input().strip().split()))\nais = list(map(int, input().strip().split()))\n\nn1 = ais.count(1)\n\none_serie = [0 for _ in range(n)]\nfor i in reversed(list(range(n))):\n\tif ais[i] == 1:\n\t\tone_serie[i] = (0 if i == n - 1 else one_serie[i + 1]) + 1\n\n\nn1_head = 0\ncount = 0\n\nfor i in range(n):\n\tp = 1\n\ts = 0\n\tif i > 0 and ais[i - 1] == 1:\n\t\tn1_head += 1\n\tn1_tail = n1 - n1_head\n\tj = i\n\twhile j < n:\n\t\tif ais[j] == 1:\n\t\t\tif p % k == 0 and 1 <= p // k - s <= one_serie[j]:\n\t\t\t\tcount += 1\n\t\t\tn1_tail -= one_serie[j]\n\t\t\ts += one_serie[j]\n\t\t\tj += one_serie[j]\n\t\telse:\n\t\t\tp *= ais[j]\n\t\t\ts += ais[j]\n\t\t\tif p == s * k:\n\t\t\t\tcount += 1\n\t\t\telif p > (s + n1_tail) * k:\n\t\t\t\tbreak\n\t\t\tj += 1\n\nprint (count)\n", "n, k = list(map(int, input().split()))\na = list(map(int, input().split()))\n\nones_ser_ie = [0 for _ in range(n)]\ncur_ones_ser_ie = 0\nones_in_tail_i = 0\nfor i in reversed(list(range(n))):\n\tif a[i] == 1:\n\t\tones_in_tail_i += 1\n\t\tcur_ones_ser_ie += 1\n\telse:\n\t\tcur_ones_ser_ie = 0\n\tones_ser_ie[i] = cur_ones_ser_ie\n\n\nres = 0\nfor i in range(n):\n\tp = 1\n\ts = 0\n\tj = i\n\tones_in_tail_j = ones_in_tail_i\n\twhile j < n:\n\t\tif a[j] == 1:\n\t\t\tcur_ones_ser_ie = ones_ser_ie[j]\n\t\t\tif p % k == 0 and 1 <= p//k-s <= cur_ones_ser_ie:\n\t\t\t\tres += 1\n\t\t\tones_in_tail_j -= cur_ones_ser_ie\n\t\t\ts += cur_ones_ser_ie\n\t\t\tj += cur_ones_ser_ie\n\t\telse:\n\t\t\tp *= a[j]\n\t\t\ts += a[j]\n\t\t\tif p == s * k:\n\t\t\t\tres += 1\n\t\t\telif p > (s + ones_in_tail_j) * k:\n\t\t\t\tbreak\n\t\t\tj += 1\n\tif a[i] == 1:\n\t\tones_in_tail_i -= 1\nprint(res)\n", "from sys import stdin\nimport math\n# stdin = open('in')\n\nn, k = map(int, stdin.readline().split())\na = [int(x) for x in stdin.readline().split()]\nnxt = [-1]*n\npref = []\nf, s = -1, 0\nfor i in range(n):\n\ts += a[i]\n\tpref.append(s)\n\tnxt[n-1-i] = f\n\tif a[n-1-i] != 1:\n\t\tf = n-1-i\nans = 0\nfor i in range(n):\n\tpos, cur = i, 0\n\tprod = 1\n\twhile 1:\n\t\tif prod > 1e18:\n\t\t\tbreak\n\t\tprod *= a[pos]\n\t\tcur += a[pos]\n\t\tif prod == k*cur:\n\t\t\tans += 1\n\t\tnt = nxt[pos]\n\t\tif nt == -1:\n\t\t\tones = n-1-pos\n\t\t\tif k*cur < prod and k*(cur+ones) >= prod:\n\t\t\t\tans += 1\n\t\t\tbreak\n\t\tones = nt - pos - 1\n\t\tif k*cur < prod and k*(cur+ones) >= prod and prod%k == 0:\n\t\t\tans += 1\n\t\tcur += ones\n\t\tpos = nt\nprint(ans)", "# https://codeforces.com/problemset/problem/992/D\nn, k =  map(int, input().split())\na    =  list(map(int, input().split()))\nmax_ =  10 ** 13 + 1\n\ndef get(l, r, x):\n    min_ =  min(l,r)\n    max_ =  max(l,r)\n    \n    if x <= min_:\n        return x + 1\n    \n    if x <= max_:\n        return min_ + 1\n    \n    return l+r+1-x\n\ndef solve(a, k):\n    cnt  = 0\n    arr  = [i  for i, x in enumerate(a) if x>1]\n    n_   = len(arr)\n    \n    for i in range(n_-1):\n        curS = 0\n        curP = 1 \n        l    = arr[i] if i == 0 else arr[i] - arr[i-1] - 1 \n        \n        for j in range(i, n_):\n            ind   = arr[j]\n            curS += a[ind]\n            curP *= a[ind]\n        \n            if curP > max_:\n                break\n            \n            if curP % curS == 0:\n                if curP // curS == k:\n                    #print(arr[i], arr[j], curP, curS)\n                    cnt+=1\n                \n            r = arr[j+1] - arr[j] - 1\n            x = curP // k - curS\n                \n            if curP % k == 0 and x > 0  and x <= l + r:\n                #print(arr[i], arr[j], curP, curS)\n                cnt+=get(l, r, x)\n            curS += r   \n    \n    if k==1:\n        cnt+=len(a)-n_\n    return cnt\n\nans=0\na.append(max_)\nans += solve(a, k)\n\nprint(ans)", "n,k = map(int,input().split())\nA = list(map(int,input().split()))\nA = [0]+A;\nx = 0\nprev = [0 for i in range(n+1)]\nsm = [0 for i in range(n+1)]\nfor i in range(1,n+1):\n\tprev[i] = x\n\tif A[i]>1:\n\t\tx = i\n\tsm[i] = A[i]+sm[i-1]\nlim = int(2*(10**18))\nans = 0\nfor i in range(1,n+1):\n\tp = 1\n\tj = i\n\twhile j:\n\t\tif lim//A[j]>p:\n\t\t\ts = sm[i]-sm[j-1]\n\t\t\tp *= A[j]\n\t\t\tif p%k == 0 and p//k>=s and j-1-prev[j]>=p/k-s:\n\t\t\t\tans += 1\n\t\telse:\n\t\t\tbreak\n\t\tj = prev[j]\nprint(ans)", "n,k = map(int,input().split())\nA = list(map(int,input().split()))\nA = [0]+A;\nx = 0\nprev = [0 for i in range(n+1)]\nsm = [0 for i in range(n+1)]\nfor i in range(1,n+1):\n\tprev[i] = x\n\tif A[i]>1:\n\t\tx = i\n\tsm[i] = A[i]+sm[i-1]\nlim = int(2*(10**18))\nans = 0\nfor i in range(1,n+1):\n\tp = 1\n\tj = i\n\twhile j:\n\t\tif lim//A[j]>p:\n\t\t\ts = sm[i]-sm[j-1]\n\t\t\tp *= A[j]\n\t\t\tsx = s+j-1-prev[j]\n\t\t\tif p%k == 0 and p>=k*s and p<=k*sx:\n\t\t\t\tans += 1\n\t\telse:\n\t\t\tbreak\n\t\tj = prev[j]\nprint(ans)"]