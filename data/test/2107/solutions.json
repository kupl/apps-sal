["def solution() : # \u6700\u5927\u7684\u8ddd\u79bb\u6765\u81ea\u4e8e\u89d2\u843d\u9644\u8fd1\u7684\u70b9\n\tn,m,k,s = map(int, input().split())\n\tdis = lambda a,b : abs(a[0] - b[0]) + abs(a[1] - b[1])\n\tcorner = [(0,0), (0,m-1), (n-1,0), (n-1,m-1)]\n\tvertex = [[(n,m), (n,-1), (-1,m), (-1,-1)] for _ in range(k+1)]\n\tfor i in range(n) :\n\t\tfor j,note in enumerate(map(int, input().split())) :\n\t\t\tvertex[note] = [\n\t\t\t\t(i,j) if dis((i,j), c) < dis(v, c) else v\n\t\t\t\tfor v,c in zip(vertex[note], corner)]\n\tmaxdis = [[-1] * (k+1) for _ in range(k+1)]\n\tpairs = [(0,3),(3,0),(1,2),(2,1)]\n\tfor i in range(1, k+1) :\n\t\tfor j in range(i, k+1) :\n\t\t\tvi,vj = vertex[i],vertex[j]\n\t\t\tmaxdis[i][j] = max(dis(vi[a], vj[b]) for a,b in pairs)\n\t\t\tmaxdis[j][i] = maxdis[i][j]\n\ts = list(map(int, input().split()))\n\tprint(max(maxdis[s[i]][s[i+1]] for i in range(len(s) - 1)))\nsolution()"]