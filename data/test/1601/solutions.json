["n = int(input())\na = [tuple(map(int, input().split())) for _ in range(n)]\ns = {a[q]: q+1 for q in range(n)}\na.sort()\nq, q1 = 0, 1\nd, d1, d2 = [[[a[0]]]], [], []\nwhile q1 < n:\n    while q1 < n and a[q][0] == a[q1][0]:\n        while q1 < n and a[q][1] == a[q1][1]:\n            d[-1][-1].append(a[q1])\n            q1 += 1\n        if q1 < n and a[q][0] == a[q1][0]:\n            d[-1].append([a[q1]])\n            q = q1\n            q1 += 1\n    if q1 < n:\n        d.append([[a[q1]]])\n        q = q1\n        q1 += 1\nfor q in range(len(d)):\n    for q1 in range(len(d[q])):\n        for q2 in range(1, len(d[q][q1]), 2):\n            print(s[d[q][q1][q2-1]], s[d[q][q1][q2]])\n        if len(d[q][q1]) % 2 == 1:\n            d[q][q1] = d[q][q1][-1]\n        else:\n            d[q][q1] = -1\nfor q in range(len(d)):\n    d1.append([])\n    for q1 in range(len(d[q])):\n        if d[q][q1] != -1:\n            d1[-1].append(d[q][q1])\nfor q in range(len(d1)):\n    for q1 in range(1, len(d1[q]), 2):\n        print(s[d1[q][q1-1]], s[d1[q][q1]])\n    if len(d1[q]) % 2 == 1:\n        d2.append(d1[q][-1])\nfor q in range(1, len(d2), 2):\n    print(s[d2[q-1]], s[d2[q]])\n", "import sys\n\nn = -1\ndata = []\nfor line in sys.stdin:\n    if n == -1:\n        n = int(line)\n        continue\n    data.append(tuple([int(i) for i in line.split()]))\n    if len(data) == n:\n        break\n\ndata = list(zip(data, list(range(1, n+1))))\ndata.sort()\n\ndata2 = []\nremovedLast = False\nfor i in range(n):\n    if removedLast:\n        removedLast = False\n        continue\n    if i+1<n and data[i][0][0] == data[i+1][0][0] and data[i][0][1] == data[i+1][0][1]:\n        print(\"%d %d\"%(data[i][1], data[i+1][1]))\n        removedLast = True\n    else:\n        data2.append(data[i])\n\ndata3 = []\nremovedLast = False\nfor i in range(len(data2)):\n    if removedLast:\n        removedLast = False\n        continue\n    if i+1<len(data2) and data2[i][0][0] == data2[i+1][0][0]:\n        print(\"%d %d\"%(data2[i][1], data2[i+1][1]))\n        removedLast = True\n    else:\n        data3.append(data2[i])\n\nfor i in range(0, len(data3), 2):\n    print(\"%d %d\"%(data3[i][1], data3[i+1][1]))\n    \n", "from sys import stdin,stdout\nn=int(stdin.readline())\nl=[]\nfor i in range(n):\n    x=list(map(int,stdin.readline().split()))\n    l.append([x,i+1])\nl.sort()\n#print(l)\ndeleted=[0]*n\nfor i in range(n-1):\n    if deleted[i]:\n        continue\n    if l[i][0][0]==l[i+1][0][0] and l[i][0][1]==l[i+1][0][1]:\n        print(l[i][1],l[i+1][1])\n        deleted[i]=deleted[i+1]=1\nremaining=[]\nfor i in range(n):\n    if deleted[i]==0:\n        remaining.append(l[i])\ndel deleted\nn=len(remaining)\ndeleted=[0]*n\nfor i in range(n-1):\n    if deleted[i]:\n        continue\n    if remaining[i][0][0]==remaining[i+1][0][0]:\n        print(remaining[i][1],remaining[i+1][1])\n        deleted[i]=deleted[i+1]=1\nlast=[]\nfor i in range(n):\n    if deleted[i]==0:\n        last.append(remaining[i])\nfor i in range(0,len(last),2):\n    print(last[i][1],last[i+1][1])\n", "import sys\nfrom collections import defaultdict\nreadline = sys.stdin.readline\n        \nN = int(readline())\n\nXYZ = [tuple(map(int, readline().split())) for _ in range(N) ]\nXYZI = [(x, y, z, i) for i, (x, y, z) in enumerate(XYZ, 1)]\n\n\nXYZI.sort()\nX, Y, Z, IDX = map(list, zip(*XYZI))\n\nDi = defaultdict(list)\nfor i in range(N):\n    x, y, z, idx = X[i], Y[i], Z[i], IDX[i]\n    Di[x].append((y, z, idx))\nAns = []\nAma = []\n\nfor L in Di.values():\n    D2 = defaultdict(int)\n    for y, _, _ in L:\n        D2[y] += 1\n    pre = None\n    st = None\n    for y, z, i in L:\n        if st is None and D2[y] == 1:\n            if pre is not None:\n                Ans.append((pre, i))\n                pre = None\n            else:\n                pre = i\n        else:\n            if st is not None:\n                Ans.append((st, i))\n                st = None\n            else:\n                st = i\n        D2[y] -= 1\n    \n    if st:\n        Ama.append(st)\n    if pre:\n        Ama.append(pre)\nLe = len(Ama)\nfor i in range(Le//2):\n    Ans.append((Ama[2*i], Ama[2*i+1]))\n\nfor a in Ans:\n    sys.stdout.write('{} {}\\n'.format(*a))", "n = int(input())\ncoors =[]\nfor i in range(n):\n    coors.append(list(map(int,input().split()))+[i+1])\n# print(coors)\ncoors=sorted(coors,key=lambda x:(x[0],x[1],x[2]))\n# for i in range(0,n,2):\n#     if coors[i][0]==coors[i+1][0]:\n#         if coors[i][1]==coors[i+1][1]:\n#             print(coors[i][3],coors[i+1][3])\n#         else:\nleft=[]\ndef oneD(co,remain):\n    if len(co)%2==0:\n        for i in range(0, len(co), 2):\n            print(co[i][3],co[i+1][3])\n    else:\n        remain.append(co[-1])\n        for i in range(0, len(co)-1, 2):\n            print(co[i][3],co[i+1][3])\n    return remain\ndef twoD(co):\n    if len(co)==1:\n        left.append(*co)\n        return\n    remain = []\n    l = 1\n    for i in range(len(co)-1):\n        if co[i][1] == co[i + 1][1]:\n            l += 1\n        else:\n            remain = oneD(co[i+1 -l:i + 1],remain)\n            l=1\n    remain = oneD(co[len(co)-l:],remain)\n    if len(remain)%2==0:\n        for i in range(0, len(remain), 2):\n            print(remain[i][3],remain[i+1][3])\n    else:\n        left.append(remain[-1])\n        for i in range(0, len(remain)-1, 2):\n            print(remain[i][3],remain[i+1][3])\n\nl=1\nfor i in range(n-1):\n    if coors[i][0]==coors[i+1][0]:\n        l+=1\n    else:\n        twoD(coors[i+1-l:i+1])\n        l=1\ntwoD(coors[n-l:])\n# print(left)\nfor i in range(0,len(left),2):\n    print(left[i][3],left[i+1][3])", "import sys\nimport math\ninput = sys.stdin.readline\n\nn=int(input())\n\narr=[]\nfor i in range(n):\n\tarr.append(list(map(int,input().split())))\n\tarr[-1].append(i+1)\n\nans=[]\narr.sort()\n#print(arr)\ndone=[0]*n\ni=0\nj=1\nwhile i<n and j<n:\n\tif arr[i][0]==arr[j][0] and arr[i][1]==arr[j][1]:\n\t\tans.append([arr[i][3], arr[j][3]])\n\t\tdone[arr[i][3]-1]+=1\n\t\tdone[arr[j][3]-1]+=1\n\t\ti+=2\n\t\tj+=2\n\telse:\n\t\ti+=1\n\t\tj+=1\n#print(ans)\n#print(done)\narr1=[]\nfor i in range(n):\n\tif done[arr[i][3]-1]==0:\n\t\tarr1.append(arr[i])\nn=len(arr1)\n#print(\"arr1\",arr1)\ni=0\nj=1\nwhile i<n and j<n:\n\tif arr1[i][0]==arr1[j][0]:\n\t\tans.append([arr1[i][3], arr1[j][3]])\n\t\tdone[arr1[i][3]-1]+=1\n\t\tdone[arr1[j][3]-1]+=1\n\t\ti+=2\n\t\tj+=2\n\telse:\n\t\ti+=1\n\t\tj+=1\n#print(ans)\narr2=[]\n#print(\"arr1\", arr1)\nfor i in range(n):\n\tif done[arr1[i][3]-1]==0:\n\t\tarr2.append(arr1[i])\n#print(done)\nn=len(arr2)\n#print(arr2)\nfor i in range(n):\n\tif i%2==0:\n\t\tans.append([arr2[i][3], arr2[i+1][3]])\n\nfor i in range(len(ans)):\n\tprint(*ans[i])", "def solve(n, p):\n    p = sorted(p, key=lambda x: (x[0], x[1], x[2]))\n    # print('solve', p)\n    p.append([10**20, 10**20, 10**20, 10**20])\n    # eliminate matching x coord ones:\n    c = 1\n    pn = []\n    for i in range(1, len(p)):\n        if p[i][0] == p[i-1][0]:\n            c += 1\n        else:\n            if c >= 2:\n                s = solve_2d(p[i-c:i])\n                if s:\n                    pn.append(s)\n            else:\n                pn.append(p[i-1])\n            c = 1\n    # print(pn)\n    for i in range(0, len(pn)-1, 2):\n        print(pn[i][3], pn[i+1][3])\n\n\ndef solve_2d(p1):\n    # print('solve_2d', p1)\n    p1.append([10**20, 10**20, 10**20, 10**20])\n    c = 1\n    p1n = []\n    i = 1\n    while i < len(p1):\n        if p1[i][1] == p1[i-1][1]:\n            print(p1[i][3], p1[i-1][3])\n            i += 2\n        else:\n            p1n.append(p1[i-1])\n            i += 1\n    for i in range(0, len(p1n)-1, 2):\n        print(p1n[i][3], p1n[i+1][3])\n    if len(p1n) % 2 == 1:\n        return p1n[-1]\n    else:\n        return 0\n\n\ndef main():\n    n = int(input())\n    p = []\n    for i in range(n):\n        pt = [int(i) for i in input().split()]\n        p.append(pt + [i+1])\n    solve(n, p)\n\n\nmain()\n", "n = int(input())\ncoord = []\nfor i in range(n):\n    coord.append(tuple(list(map(int,input().split()))+[i+1]))\ncoord.sort()\ndef odind(l):\n    l.sort()\n    for i in range(len(l)//2):\n        print(l[2*i][-1],l[2*i+1][-1])\n    if len(l)%2==0:\n        return []\n    return l[-1]\ndef dvad(l):\n    cx = {}\n    ans1 = []\n    for x,y,n in l:\n        if x in cx:\n            cx[x].append([y,n])\n        else:\n            cx[x] = [[y,n]]\n    for x,j in cx.items():\n        v = odind(j)\n        if len(v)!=0:\n            ans1.append(tuple([x]+v))\n    ans1.sort()\n    for i in range(len(ans1)//2):\n        print(ans1[2*i][-1],ans1[2*i+1][-1])\n    if len(ans1)%2==0:\n        return []\n    return ans1[-1]\ndef trid(l):\n    cx = {}\n    ans1 = []\n    for x, y,z, n in l:\n        if x in cx:\n            cx[x].append((y, z, n))\n        else:\n            cx[x] = [(y, z, n)]\n    for x,j in cx.items():\n        v = list(dvad(j))\n        if len(v) != 0:\n            ans1.append(tuple([x]+v))\n    ans1.sort()\n    for i in range(len(ans1) // 2):\n        print(ans1[2 * i][-1], ans1[2 * i + 1][-1])\ntrid(coord)", "from sys import stdin\ninput = stdin.readline\nn = int(input())\nl = [list(map(int,input().split())) for i in range(n)]\na = [[l[i],i+1] for i in range(n)]\nused = [0] * (n+1)\na.sort()\nd = {}\nfor i in a:\n\td[i[0][0]] = []\nfor i in a:\n\td[i[0][0]].append([i[0][1],i[0][2], i[1]])\nfor x in d:\n\t#doing for 2d\n\tl = d[x] # this is restricted to x-coordinate\n\tb = {}\n\tfor i in l:\n\t\tb[i[0]] = []\n\tfor i in l:\n\t\tb[i[0]].append([i[1], i[2]]) #{z, n}\n\tfor y in b:\n\t\tpom = 0\n\t\twhile pom + 1 < len(b[y]):\n\t\t\tprint(b[y][pom][1], b[y][pom+1][1])\n\t\t\tused[b[y][pom][1]] = 1\n\t\t\tused[b[y][pom+1][1]] = 1\n\t\t\tpom += 2\n\tc = []\n\tfor gg in l:\n\t\tif used[gg[2]] == 0:\n\t\t\tc.append(gg)\n\tcc = [[c[gg][0], c[gg][2]] for gg in range(len(c))]\n\tg = 0\n\twhile g < len(cc) - 1:\n\t\tprint(cc[g][-1], cc[g+1][-1])\n\t\tused[cc[g][-1]] = 1\n\t\tused[cc[g+1][-1]] = 1\n\t\tg += 2\nc = []\nfor i in range(0, n):\n\tif used[a[i][1]] == 0:\n\t\tc.append([a[i][0][0],a[i][1]])\nc.sort()\ni = 0\nwhile i < len(c) - 1:\n\tprint(c[i][1], c[i+1][1])\n\ti += 2", "n = int(input())\npoints = []\n\nfor i in range(n):\n    points.append(list(map(int, input().split())))\n    points[i].append(i+1)\npoints.sort()\n\nrem = []\n\ni = 0\nwhile i < len(points):\n    if i < len(points)-1 and points[i][:2] == points[i+1][:2]:\n        print(points[i][3],points[i+1][3])\n        i+=2\n    else:\n        rem.append(points[i])\n        i+=1\npoints = list(rem)\nrem = []\ni = 0\nwhile i < len(points):\n    if i < len(points)-1 and points[i][0] == points[i+1][0]:\n        print(points[i][3],points[i+1][3])\n        i+=2\n    else:\n        rem.append(points[i])\n        i+=1\n#print(rem)\npoints = list(rem)\nrem = []\ni = 0\nwhile i < len(points)-1:\n    print(points[i][3], points[i+1][3])\n    i+=2\n\n\n\n", "\"\"\"\n    > File Name: c.py\n    > Author: Code_Bear\n    > Mail: secret \n    > Created Time: Thu Oct 17 16:34:03 2019\n\"\"\"\nfrom collections import OrderedDict\ndef SortPoint(p, ids, k, D):\n    if k == D:\n        return ids[0]\n    maps = OrderedDict()\n    for i in ids:\n        if p[i][k] not in maps:\n            maps[p[i][k]] = []\n        maps[p[i][k]].append(i)\n    a = []\n    for i in sorted(maps.keys()):\n        cnt = SortPoint(p, maps[i], k + 1, D)\n        if cnt != -1: a.append(cnt)\n    for i in range(0, len(a), 2):\n        if i + 1 < len(a):\n            print(a[i] + 1, a[i + 1] + 1)\n    return -1 if len(a) % 2 == 0 else a[-1]\n            \n\ndef solver():\n    n = int(input())\n    p = []\n    ids = [i for i in range(n)]\n    for i in range(n):\n        point = list(map(int, input().split()))\n        p.append(point)\n    SortPoint(p, ids, 0, 3)\n    \ndef main():\n    while 1:\n        try:\n            solver()\n        except EOFError:\n            break\n\ndef __starting_point():\n    main()\n__starting_point()", "def solve(points,ans,coords,x):\n    arr = []\n    curr = []\n    y = points[0][0]\n    for p in points:\n        if p[0] == y:\n            curr.append((y,p[1],p[2]))\n        else:\n            arr.append(curr)\n            y = p[0]\n            curr = [(y,p[1],p[2])]\n\n    arr.append(curr)\n\n    arr1 = []\n\n    for i in arr:\n        while len(i) >= 2:\n            ans.append((i.pop(0)[2],i.pop(0)[2]))\n\n        if len(i) == 1:\n            arr1.append((i[0][0],i[0][1],i[0][2]))\n\n    while len(arr1) >= 2:\n        ans.append((arr1.pop(0)[2],arr1.pop(0)[2]))\n\n    coords[x] = arr1[:]\n\ndef main():\n    n = int(input())\n    points = []\n    coords = {}\n    for i in range(n):\n        x,y,z = list(map(int,input().split()))\n        if x not in list(coords.keys()):\n            coords[x] = [(y,z,i+1)]\n        else:\n            coords[x].append((y,z,i+1))\n\n    ans = []\n\n    for i in list(coords.keys()):\n        coords[i].sort()\n        if len(coords[i]) > 1:\n            solve(coords[i],ans,coords,i)\n\n        if len(coords[i]) == 1:\n            points.append((i,coords[i][0][0],coords[i][0][1],coords[i][0][2]))\n\n    points.sort()\n\n    for i in range(0,len(points),2):\n        a,b = points[i][3],points[i+1][3]\n        ans.append((a,b))\n\n    for i in ans:\n        print(i[0],i[1])\n\nmain()\n", "def d(le):\n    for i in range(0,len(le),2):\n    #    if le[i][3]==29 and le[i+1][3]==38:\n     #       print(me)\n      #      return ''\n        print(le[i][3],le[i+1][3])\n    \ndef dd(it):\n    nonlocal do\n   # print(it)\n    tt={}\n    ddd=[]\n    it.sort(key=lambda x:x[1])\n    l=list(set([i[1] for i in it]))\n    l.sort()\n    for i in l:\n        tt[i]=[]\n    for i in it:\n        tt[i[1]].append(i)\n    for i in l:\n        x=tt[i]\n        if len(x)%2==1:\n            ddd.append(x[-1][:])\n            x=x[:-1]\n        if len(x)>0:\n            x.sort(key=lambda x:x[2])\n            d(x[:])\n    if len(ddd)%2==1:\n        do.append(ddd[-1][:])\n        ddd=ddd[:-1]\n    if len(ddd)>0:\n        ddd.sort(key=lambda x:x[1])\n        d(ddd)\nn=int(input())\nit=[]\nfor i in range(n):\n    it.append(list(map(int,input().split()))+[i+1])\nss={}\nit.sort()\nl=list(set([i[0] for i in it]))\nl.sort()\nfor i in l:\n    ss[i]=[]\nfor i in it:\n    ss[i[0]].append(i)\ndo=[]\nfor i in l:\n    x=ss[i]\n    dd(x[:])\n#do.sort(key=lambda x:x[2])\nd(do)\n\n    \n    \n", "n = int(input())\nsentinel = [(10**9, 10**9, 10**9)]\npoints = sorted(tuple(map(int, input().split())) + (i,) for i in range(1, n+1)) + sentinel\nans = []\nrem = []\n\ni = 0\nwhile i < n:\n    if points[i][:2] == points[i+1][:2]:\n        ans.append(f'{points[i][-1]} {points[i+1][-1]}')\n        i += 2\n    else:\n        rem.append(i)\n        i += 1\n\nrem += [n]\nrem2 = []\n\nn = len(rem)\ni = 0\nwhile i < n-1:\n    if points[rem[i]][0] == points[rem[i+1]][0]:\n        ans.append(f'{points[rem[i]][-1]} {points[rem[i+1]][-1]}')\n        i += 2\n    else:\n        rem2.append(points[rem[i]][-1])\n        i += 1\n\nprint(*ans, sep='\\n')\nfor i in range(0, len(rem2), 2):\n    print(rem2[i], rem2[i+1])"]